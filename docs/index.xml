<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>花園シャトー107号室</title>
    <link>https://hanazonochateau.net/</link>
    <description>Recent content on 花園シャトー107号室</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>ja-jp</language>
    <lastBuildDate>Sat, 03 Dec 2022 16:53:08 +0900</lastBuildDate>
    
	<atom:link href="https://hanazonochateau.net/index.xml" rel="self" type="application/rss+xml" />
    
    
    
    <item>
      <title>2022年振り返り</title>
      <link>https://hanazonochateau.net/posts/2022/12/03/look-back-2022/</link>
      <pubDate>Sat, 03 Dec 2022 16:53:08 +0900</pubDate>
      
      <guid>https://hanazonochateau.net/posts/2022/12/03/look-back-2022/</guid>
      <description>&lt;p&gt;これは &lt;a href=&#34;https://adventar.org/calendars/8236&#34;  target=&#34;_blank&#34; &gt;WORDIAN Advent Calendar 2022&lt;/a&gt; の3日目の記事です。&lt;/p&gt;
&lt;h2 id=&#34;師走&#34;&gt;師走&lt;/h2&gt;
&lt;p&gt;12月にも突入したし、2022年の振り返りをそろそろしていきたいと思います。&lt;/p&gt;
&lt;h2 id=&#34;1月&#34;&gt;1月&lt;/h2&gt;
&lt;p&gt;卒論を書いていました。&lt;/p&gt;
&lt;h2 id=&#34;2月&#34;&gt;2月&lt;/h2&gt;
&lt;p&gt;卒論発表会をやったはず。記憶が、ない……。&lt;/p&gt;
&lt;h2 id=&#34;3月&#34;&gt;3月&lt;/h2&gt;
&lt;p&gt;暇を持て余しインターネットとツイッタースペースをたくさんやりました。&lt;/p&gt;
&lt;h2 id=&#34;4月&#34;&gt;4月&lt;/h2&gt;
&lt;p&gt;入社しました。入社式の一言で盛大につまり恥をかきました。&lt;/p&gt;
&lt;h2 id=&#34;5月&#34;&gt;5月&lt;/h2&gt;
&lt;p&gt;車を買いました。
会社では研修をしてました。&lt;/p&gt;
&lt;h2 id=&#34;6月&#34;&gt;6月&lt;/h2&gt;
&lt;p&gt;研修してました２（ツー）。&lt;/p&gt;
&lt;h2 id=&#34;7月&#34;&gt;7月&lt;/h2&gt;
&lt;p&gt;研修してました３（スリー）。&lt;/p&gt;
&lt;h2 id=&#34;8月&#34;&gt;8月&lt;/h2&gt;
&lt;p&gt;セキュリティキャンプのチューターとかしたりしてました。&lt;/p&gt;
&lt;h2 id=&#34;9月&#34;&gt;9月&lt;/h2&gt;
&lt;p&gt;少し遅めの夏休みで虚無を過ごしました。
あと大学を卒業しました。
学士（情報工学）、ゲットだぜ！&lt;/p&gt;
&lt;h2 id=&#34;10月&#34;&gt;10月&lt;/h2&gt;
&lt;p&gt;仕事してました。&lt;/p&gt;
&lt;h2 id=&#34;11月&#34;&gt;11月&lt;/h2&gt;
&lt;p&gt;仕事してました２（ツー）。記憶が、ない……。&lt;/p&gt;
&lt;h2 id=&#34;今年よく聴いた曲&#34;&gt;今年よく聴いた曲&lt;/h2&gt;
&lt;p&gt;この振り返りではあまりにも味気ないので、soundcloudで今年よく聴いた曲を貼ります。&lt;/p&gt;
&lt;h3 id=&#34;-summer-of-j-core---いえブ夏-2022&#34;&gt;-Summer of J-CORE- @ #いえブ夏 2022&lt;/h3&gt;
&lt;p&gt;&lt;a href=&#34;https://soundcloud.com/deswide/iebu-natsu2022&#34;  target=&#34;_blank&#34; &gt;https://soundcloud.com/deswide/iebu-natsu2022&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;J-COREのDJ録音で大体1時間くらいあります。
車の中でずっとかけていました。
メジャーどころが詰まっていて、かなりノリやすい構成だと思います。&lt;/p&gt;
&lt;h2 id=&#34;2022年まとめ&#34;&gt;2022年まとめ&lt;/h2&gt;
&lt;p&gt;入社、車購入、卒業、これ以外に、俺は、何も……。&lt;/p&gt;
</description>
    </item>
    
    
    
    <item>
      <title>CakeCTF 2022 Writeup</title>
      <link>https://hanazonochateau.net/posts/2022/09/05/cakectf2022/</link>
      <pubDate>Mon, 05 Sep 2022 08:18:40 +0900</pubDate>
      
      <guid>https://hanazonochateau.net/posts/2022/09/05/cakectf2022/</guid>
      <description>&lt;p&gt;CakeCTF 2022 に &lt;a href=&#34;https://dcdcnation.com/&#34;  target=&#34;_blank&#34; &gt;DCDC&lt;/a&gt; として参加し、 その内の kiwi という問題を解きました。
楽しかった一方、自分にとっては難しい問題が多く、まだまだ力をつける必要があるなと感じました。&lt;/p&gt;
&lt;h2 id=&#34;rev-kiwi&#34;&gt;[rev] kiwi&lt;/h2&gt;
&lt;p&gt;バイナリとダミーのflag.txt、それに接続先が提示されます。
バイナリを起動してみるとプロンプトが表示され、正しいキーを入力するとフラグが表示されるようです。&lt;/p&gt;
&lt;p&gt;最初に種明かしをすると、有効なキーを入力すると、そのキーで暗号化されたフラグが出力されます。
まず有効なキーのパターンを解析し、その後暗号化されたフラグを復号化するという二段構成になっています。&lt;/p&gt;
&lt;p&gt;解析にはGhidraを用いました。&lt;/p&gt;
&lt;h3 id=&#34;有効なキーのパターンを見つける&#34;&gt;有効なキーのパターンを見つける&lt;/h3&gt;
&lt;p&gt;入力されたキーが有効か判定し、それを用いているのは &lt;code&gt;cakectf::EncryptionKey::decode&lt;/code&gt; です。&lt;/p&gt;
&lt;p&gt;関数内部に &lt;code&gt;set_key&lt;/code&gt; と &lt;code&gt;set_magic&lt;/code&gt; という関数があり、この関数たちを呼び出すことで暗号化の準備が完成します。
Ghidraでデコンパイルするとif文が入り組んでおり、このif文をかいくぐってこれらの関数を呼び出すようなキーを入力する必要があります。&lt;/p&gt;
&lt;p&gt;まずは前半部分です。&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;    &lt;span class=&#34;k&#34;&gt;while&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;true&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
      &lt;span class=&#34;n&#34;&gt;cVar2&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;kiwi&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;::&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ByteBuffer&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;::&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;readVarUint&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;bytebuf&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;local_34&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
      &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;cVar2&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;!=&lt;/span&gt; &lt;span class=&#34;sc&#34;&gt;&amp;#39;\x01&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
        &lt;span class=&#34;n&#34;&gt;uVar3&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
        &lt;span class=&#34;k&#34;&gt;goto&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;LAB_00106145&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
      &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
      &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;local_34&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;!=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;break&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;  &lt;span class=&#34;cm&#34;&gt;/* (1) */&lt;/span&gt;
      &lt;span class=&#34;n&#34;&gt;cVar2&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;kiwi&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;::&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ByteBuffer&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;::&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;readVarUint&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;bytebuf&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;local_38&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
      &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;cVar2&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;!=&lt;/span&gt; &lt;span class=&#34;sc&#34;&gt;&amp;#39;\x01&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
        &lt;span class=&#34;n&#34;&gt;uVar3&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
        &lt;span class=&#34;k&#34;&gt;goto&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;LAB_00106145&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
      &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
      &lt;span class=&#34;n&#34;&gt;local_28&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Array&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;unsigned_char&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;set_key&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;this&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;mempool&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;local_38&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt; &lt;span class=&#34;cm&#34;&gt;/* (2) */&lt;/span&gt;
      &lt;span class=&#34;n&#34;&gt;local_30&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;uchar&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;kiwi&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;::&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Array&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;unsigned_char&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;gt;::&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;begin&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;local_28&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
      &lt;span class=&#34;n&#34;&gt;local_20&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;uchar&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;kiwi&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;::&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Array&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;unsigned_char&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;gt;::&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;end&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;local_28&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
      &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;local_30&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;!=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;local_20&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;local_30&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;local_30&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt; &lt;span class=&#34;cm&#34;&gt;/* (3) */&lt;/span&gt;
        &lt;span class=&#34;n&#34;&gt;local_18&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;local_30&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
        &lt;span class=&#34;n&#34;&gt;cVar2&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;kiwi&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;::&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ByteBuffer&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;::&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;readByte&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;bytebuf&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;local_30&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
        &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;cVar2&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;!=&lt;/span&gt; &lt;span class=&#34;sc&#34;&gt;&amp;#39;\x01&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
          &lt;span class=&#34;n&#34;&gt;uVar3&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
          &lt;span class=&#34;k&#34;&gt;goto&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;LAB_00106145&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
        &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
      &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;em&gt;(1)&lt;/em&gt; の部分から、 &lt;code&gt;set_key&lt;/code&gt; にたどり着くには &lt;code&gt;readVarUint&lt;/code&gt; で &lt;code&gt;local_34&lt;/code&gt; に対して2を出力する必要がありそうです。
&lt;code&gt;readVarUint&lt;/code&gt; は内部で &lt;code&gt;readByte&lt;/code&gt; という関数を呼び出してwhileループしています。
実験したら、 &lt;code&gt;readVarUint&lt;/code&gt; は2文字ずつ読んで数値に変換する関数のようでした。
したがって最初の2文字は &lt;strong&gt;02&lt;/strong&gt; でよさそうです。&lt;/p&gt;
&lt;p&gt;&lt;em&gt;(2)&lt;/em&gt; の &lt;code&gt;set_key&lt;/code&gt; 内部は次のようになっています。&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span class=&#34;n&#34;&gt;EncryptionKey&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;__thiscall&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;cakectf&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;::&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;EncryptionKey&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;::&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;set_key&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;EncryptionKey&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;this&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;MemoryPool&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;param_1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;uint&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;param_2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
  &lt;span class=&#34;c1&#34;&gt;//(...snip...)
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;  
  &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;uint&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;this&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;uint&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;this&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;|&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
  &lt;span class=&#34;n&#34;&gt;AVar2&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;kiwi&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;::&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;MemoryPool&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;::&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;array&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;unsigned_char&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;param_1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;param_2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;

  &lt;span class=&#34;c1&#34;&gt;// (...snip...)
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;  &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;this&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;8&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;やってることは、EncryptionKey内部のフラグを立てるかなんかして、MemoryPoolにArrayを作っています。
&lt;code&gt;param_2&lt;/code&gt; が要素数らしいです。&lt;/p&gt;
&lt;p&gt;次の入力は要素数が入るらしいので、とりあえず &lt;strong&gt;08&lt;/strong&gt; とかにしておきます。&lt;/p&gt;
&lt;p&gt;&lt;em&gt;(3)&lt;/em&gt; のforループでさっきのArrayに値を読み込んで格納しているっぽいですね。
さっき要素数8にしたので、とりあえず8個分ゼロで埋めておきましょう。
&lt;strong&gt;0000000000000000&lt;/strong&gt; で。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;0123456789abcdef&lt;/strong&gt; とかでもいいのですが、後々面倒になります。
理由は読み進めるとわかります。&lt;/p&gt;
&lt;p&gt;このwhile文にはもう用はないので &lt;em&gt;(1)&lt;/em&gt; で2以外をあたえてbreakします。
何を与えるといいかというのは後半部に書いてあります。&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;    &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;local_34&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
      &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;local_34&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;==&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
        &lt;span class=&#34;n&#34;&gt;uVar3&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;         &lt;span class=&#34;cm&#34;&gt;/* (10) */&lt;/span&gt;
        &lt;span class=&#34;k&#34;&gt;goto&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;LAB_00106145&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
      &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
      &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;local_34&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;==&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt; &lt;span class=&#34;cm&#34;&gt;/* (4) */&lt;/span&gt;
        &lt;span class=&#34;n&#34;&gt;cVar2&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;kiwi&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;::&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ByteBuffer&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;::&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;readVarUint&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;bytebuf&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;uint&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;this&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x18&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;));&lt;/span&gt;
        &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;cVar2&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;!=&lt;/span&gt; &lt;span class=&#34;sc&#34;&gt;&amp;#39;\x01&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
          &lt;span class=&#34;n&#34;&gt;uVar3&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
          &lt;span class=&#34;k&#34;&gt;goto&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;LAB_00106145&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
        &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
        &lt;span class=&#34;n&#34;&gt;set_magic&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;this&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;uint&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;this&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x18&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;));&lt;/span&gt; &lt;span class=&#34;cm&#34;&gt;/* (5) */&lt;/span&gt;
        &lt;span class=&#34;k&#34;&gt;goto&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;LAB_00105fd5&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
      &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;code&gt;set_magic&lt;/code&gt; にも入っておきたいので、 &lt;em&gt;(4)&lt;/em&gt; から、次の値は &lt;strong&gt;01&lt;/strong&gt; にしましょう。&lt;/p&gt;
&lt;p&gt;&lt;em&gt;(5)&lt;/em&gt; の &lt;code&gt;set_magic&lt;/code&gt; は次のようになっています。&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span class=&#34;kt&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;__thiscall&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;cakectf&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;::&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;EncryptionKey&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;::&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;set_magic&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;EncryptionKey&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;this&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;uint&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;param_1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
  &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;uint&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;this&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;uint&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;this&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;|&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
  &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;uint&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;this&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x18&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;param_1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
  &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;code&gt;EncryptionKey&lt;/code&gt; の内部ビットを立てて、 &lt;code&gt;param_1&lt;/code&gt; の値を &lt;code&gt;EncryptionKey&lt;/code&gt; 内部にコピーしています。&lt;/p&gt;
&lt;p&gt;さて、続きに何を入れるかですが、実は先の処理を見る必要があります。&lt;/p&gt;
&lt;p&gt;&lt;code&gt;main&lt;/code&gt; 内部の続きの &lt;code&gt;checkMessage&lt;/code&gt; 関数を見ます。&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span class=&#34;n&#34;&gt;undefined8&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;checkMessage&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;EncryptionKey&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;param_1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;

&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
  &lt;span class=&#34;n&#34;&gt;uint&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;uVar1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
  &lt;span class=&#34;kt&#34;&gt;long&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;lVar2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
  &lt;span class=&#34;n&#34;&gt;undefined8&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;uVar3&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
  &lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;piVar4&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
  &lt;span class=&#34;n&#34;&gt;Array&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;unsigned_char&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;this&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
  
  &lt;span class=&#34;n&#34;&gt;lVar2&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;cakectf&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;::&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;EncryptionKey&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;::&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;magic&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;param_1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
  &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;lVar2&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;==&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
    &lt;span class=&#34;n&#34;&gt;uVar3&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
  &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
  &lt;span class=&#34;k&#34;&gt;else&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
    &lt;span class=&#34;n&#34;&gt;piVar4&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;cakectf&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;::&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;EncryptionKey&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;::&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;magic&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;param_1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
    &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;piVar4&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;==&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0xcafec4f3&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt; &lt;span class=&#34;cm&#34;&gt;/* (6) */&lt;/span&gt;
      &lt;span class=&#34;n&#34;&gt;lVar2&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;cakectf&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;::&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;EncryptionKey&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;::&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;key&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;param_1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
      &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;lVar2&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;==&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
        &lt;span class=&#34;n&#34;&gt;uVar3&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
      &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
      &lt;span class=&#34;k&#34;&gt;else&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
        &lt;span class=&#34;n&#34;&gt;this&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Array&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;unsigned_char&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;cakectf&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;::&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;EncryptionKey&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;::&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;key&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;param_1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
        &lt;span class=&#34;n&#34;&gt;uVar1&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;kiwi&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;::&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Array&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;unsigned_char&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;gt;::&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;size&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;this&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
        &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;uVar1&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;8&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
          &lt;span class=&#34;n&#34;&gt;uVar3&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
        &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
        &lt;span class=&#34;k&#34;&gt;else&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
          &lt;span class=&#34;n&#34;&gt;uVar3&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
        &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
      &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
    &lt;span class=&#34;k&#34;&gt;else&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
      &lt;span class=&#34;n&#34;&gt;uVar3&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
  &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
  &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;uVar3&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;em&gt;(6)&lt;/em&gt; の &lt;code&gt;cafec4f3&lt;/code&gt; がもう怪しすぎますね。&lt;/p&gt;
&lt;p&gt;&lt;code&gt;magic&lt;/code&gt; 関数の戻り値が &lt;code&gt;cafec4f3&lt;/code&gt; になればよさそうです。
&lt;code&gt;magic&lt;/code&gt; 関数は以下のようになっています。&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span class=&#34;n&#34;&gt;EncryptionKey&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;__thiscall&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;cakectf&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;::&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;EncryptionKey&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;::&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;magic&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;EncryptionKey&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;this&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
  &lt;span class=&#34;n&#34;&gt;EncryptionKey&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;pEVar1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
  
  &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;((&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;uint&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;this&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;amp;&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;==&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
    &lt;span class=&#34;n&#34;&gt;pEVar1&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;EncryptionKey&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0x0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
  &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
  &lt;span class=&#34;k&#34;&gt;else&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
    &lt;span class=&#34;n&#34;&gt;pEVar1&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;this&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x18&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
  &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
  &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;pEVar1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;code&gt;EncryptionKey&lt;/code&gt; の1ビット目が立っていればオフセット0x18の値を返し、そうでなければ0を返します。
このビットは &lt;code&gt;set_magic&lt;/code&gt; で立ててあるので大丈夫です。&lt;/p&gt;
&lt;p&gt;これより、次に入力する文字列は &lt;code&gt;cafec4f3&lt;/code&gt; &amp;hellip;かと思いきや、ちょっとひねりが入れてあります。
&lt;code&gt;readVarUint&lt;/code&gt; を見てみましょう。&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span class=&#34;n&#34;&gt;undefined8&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;__thiscall&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;kiwi&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;::&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ByteBuffer&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;::&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;readVarUint&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ByteBuffer&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;this&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;uint&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;param_1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
  &lt;span class=&#34;c1&#34;&gt;// (...snip...)
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;
  &lt;span class=&#34;n&#34;&gt;local_11&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
  &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;param_1&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
  &lt;span class=&#34;k&#34;&gt;do&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
    &lt;span class=&#34;n&#34;&gt;cVar1&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;readByte&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;this&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;local_12&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
    &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;cVar1&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;!=&lt;/span&gt; &lt;span class=&#34;sc&#34;&gt;&amp;#39;\x01&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
      &lt;span class=&#34;n&#34;&gt;uVar2&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
      &lt;span class=&#34;k&#34;&gt;goto&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;LAB_00104ddd&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
    &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;param_1&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;param_1&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;|&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;local_12&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;amp;&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x7f&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;local_11&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;amp;&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x1f&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt; &lt;span class=&#34;cm&#34;&gt;/* (8) */&lt;/span&gt;
    &lt;span class=&#34;n&#34;&gt;local_11&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;local_11&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;7&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;                                      &lt;span class=&#34;cm&#34;&gt;/* (9) */&lt;/span&gt;
  &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;while&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(((&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;char&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;local_12&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&#34;sc&#34;&gt;&amp;#39;\0&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;local_11&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x23&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;));&lt;/span&gt;
  &lt;span class=&#34;n&#34;&gt;uVar2&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;span class=&#34;nl&#34;&gt;LAB_00104ddd&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
  &lt;span class=&#34;c1&#34;&gt;// (...snip...)
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;em&gt;(8)&lt;/em&gt; で読んだ数値を0x7fで論理積を取り、さらに &lt;code&gt;local_11&lt;/code&gt; でシフトしています。
また &lt;em&gt;(9)&lt;/em&gt; を見ると &lt;code&gt;local_11&lt;/code&gt; は7ビットずつシフトしています。&lt;/p&gt;
&lt;p&gt;これらを考慮に入れると、数値0xcafec4f3を &lt;code&gt;magic&lt;/code&gt; 関数から出力させるには、計算すると、 &lt;strong&gt;f389fbd78c&lt;/strong&gt; を入力する必要があることがわかります。
この辺は紙と鉛筆で計算しました。&lt;/p&gt;
&lt;p&gt;最後に &lt;code&gt;decode&lt;/code&gt; 関数を脱出するには &lt;em&gt;(10)&lt;/em&gt; から &lt;strong&gt;00&lt;/strong&gt; を入力します。&lt;/p&gt;
&lt;p&gt;これまでの入力を合わせると、 &lt;strong&gt;0208000000000000000001f389fbd78c00&lt;/strong&gt; となります。
これを入力すると、無事暗号化されたフラグが出力されます。&lt;/p&gt;
&lt;p&gt;サーバに接続し、上記の入力をすると、以下のフラグが返ってきました。&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;bc9f9699b8aebf8380c5aa9ac0c195af9bdeb29c99d99fdb8992baa38c8d868cba81bbaeebb786aba3e2bbb0e7a0b5e1b5ffa3ab94afbffbb5bfb1acf2aca6bd
&lt;/code&gt;&lt;/pre&gt;&lt;h3 id=&#34;暗号化されたフラグを復号する&#34;&gt;暗号化されたフラグを復号する&lt;/h3&gt;
&lt;p&gt;さて、暗号化されたフラグが手に入ったところで第二ラウンド開始です。
暗号化処理は &lt;code&gt;main&lt;/code&gt; 内の &lt;code&gt;encryptFlag&lt;/code&gt; で行っています。
以下がデコンパイル結果です。&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span class=&#34;n&#34;&gt;basic_string&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;encryptFlag&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;basic_string&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;enc_flag&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Array&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;raw_flag&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
  &lt;span class=&#34;c1&#34;&gt;// (...snip...)
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;  &lt;span class=&#34;n&#34;&gt;std&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;::&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;vector&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;unsigned_char&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;std&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;::&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;allocator&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;unsigned_char&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;gt;&amp;gt;::&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;vector&lt;/span&gt;
            &lt;span class=&#34;p&#34;&gt;((&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;vector&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;unsigned_char&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;std&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;::&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;allocator&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;unsigned_char&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;enc_flag&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
  &lt;span class=&#34;n&#34;&gt;std&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;::&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;__cxx11&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;::&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;basic_string&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;char&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;std&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;::&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;char_traits&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;char&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;std&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;::&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;allocator&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;char&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;gt;&amp;gt;::&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;size&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;
                    &lt;span class=&#34;cm&#34;&gt;/* try { // try from 0010649e to 00106536 has its CatchHandler @ 00106541 */&lt;/span&gt;
  &lt;span class=&#34;n&#34;&gt;std&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;::&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;vector&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;unsigned_char&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;std&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;::&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;allocator&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;unsigned_char&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;gt;&amp;gt;::&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;reserve&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;((&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ulong&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;enc_flag&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
  &lt;span class=&#34;n&#34;&gt;local_28&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
  &lt;span class=&#34;k&#34;&gt;while&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;true&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
    &lt;span class=&#34;n&#34;&gt;uVar3&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;std&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;::&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;__cxx11&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;::&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;basic_string&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;char&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;std&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;::&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;char_traits&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;char&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;std&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;::&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;allocator&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;char&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;gt;&amp;gt;::&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;size&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;
    &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;uVar3&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;lt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;local_28&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;break&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
    &lt;span class=&#34;n&#34;&gt;pcVar4&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;char&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;std&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;::&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;__cxx11&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;::&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;basic_string&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;char&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;std&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;::&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;char_traits&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;char&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;std&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;::&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;allocator&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;char&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;gt;&amp;gt;::&lt;/span&gt;
                     &lt;span class=&#34;n&#34;&gt;operator&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[]((&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ulong&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;raw_flag&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
    &lt;span class=&#34;n&#34;&gt;cVar1&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;pcVar4&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
    &lt;span class=&#34;n&#34;&gt;lVar5&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;kiwi&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;::&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Array&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;unsigned_char&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;gt;::&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;data&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;in_RDX&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt; &lt;span class=&#34;cm&#34;&gt;/* (12) */&lt;/span&gt;
    &lt;span class=&#34;n&#34;&gt;uVar2&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;kiwi&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;::&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Array&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;unsigned_char&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;gt;::&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;size&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;in_RDX&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
    &lt;span class=&#34;n&#34;&gt;local_30&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;long&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)(&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)((((&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;uint&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;byte&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;local_28&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;%&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ulong&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;uVar2&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;lVar5&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;^&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;cVar1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;amp;&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0xff&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;
                           &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;uint&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;uint3&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;cVar1&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;7&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;8&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;^&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0xff&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;^&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;local_28&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;cm&#34;&gt;/* (11) */&lt;/span&gt;
    &lt;span class=&#34;n&#34;&gt;std&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;::&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;vector&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;unsigned_char&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;std&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;::&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;allocator&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;unsigned_char&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;gt;&amp;gt;::&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;emplace_back&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;unsigned_long&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;gt;&lt;/span&gt;
              &lt;span class=&#34;p&#34;&gt;((&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;vector&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;unsigned_char&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;std&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;::&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;allocator&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;unsigned_char&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;enc_flag&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;local_30&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
    &lt;span class=&#34;n&#34;&gt;local_28&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;local_28&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
  &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
  &lt;span class=&#34;c1&#34;&gt;// (...snip...)
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;  &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;enc_flag&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;while内の &lt;em&gt;(11)&lt;/em&gt; が暗号化処理の核です。&lt;/p&gt;
&lt;p&gt;&lt;code&gt;lVar5&lt;/code&gt; と &lt;code&gt;uVar2&lt;/code&gt; はコードをじっとにらむとあの &lt;strong&gt;0000000000000000&lt;/strong&gt; のデータとサイズということがわかります。
また、 &lt;code&gt;(uint)*(byte *)(local_28 % (ulong)uVar2 + lVar5)&lt;/code&gt; あたりは &lt;code&gt;lVar5[local_28 % (ulong)uVar2]&lt;/code&gt; と見えます。
ここで &lt;code&gt;lVar5&lt;/code&gt; は全て0なのでちょっと楽になり、
最終的には &lt;code&gt;((0 ^ cVar1) &amp;amp; 0xff | (uint)(uint3)(cVar1 &amp;gt;&amp;gt; 7) &amp;lt;&amp;lt; 8) ^ 0xff) ^ i&lt;/code&gt; (ここで &lt;code&gt;i&lt;/code&gt; はループ変数)が暗号化処理だとわかります。&lt;/p&gt;
&lt;p&gt;これらの情報を基に &lt;code&gt;solve.cpp&lt;/code&gt; を書きました。&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-cpp&#34; data-lang=&#34;cpp&#34;&gt;&lt;span class=&#34;cp&#34;&gt;#include&lt;/span&gt; &lt;span class=&#34;cpf&#34;&gt;&amp;lt;cstdio&amp;gt;&lt;/span&gt;&lt;span class=&#34;cp&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;cp&#34;&gt;#include&lt;/span&gt; &lt;span class=&#34;cpf&#34;&gt;&amp;lt;string&amp;gt;&lt;/span&gt;&lt;span class=&#34;cp&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;cp&#34;&gt;#include&lt;/span&gt; &lt;span class=&#34;cpf&#34;&gt;&amp;lt;vector&amp;gt;&lt;/span&gt;&lt;span class=&#34;cp&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;cp&#34;&gt;#include&lt;/span&gt; &lt;span class=&#34;cpf&#34;&gt;&amp;lt;iostream&amp;gt;&lt;/span&gt;&lt;span class=&#34;cp&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;cp&#34;&gt;&lt;/span&gt;
&lt;span class=&#34;k&#34;&gt;using&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;namespace&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;std&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;

&lt;span class=&#34;k&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;string&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;enc_flag&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s&#34;&gt;&amp;#34;bc9f9699b8aebf8380c5aa9ac0c195af9bdeb29c99d99fdb8992baa38c8d868cba81bbaeebb786aba3e2bbb0e7a0b5e1b5ffa3ab94afbffbb5bfb1acf2aca6bd&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;

&lt;span class=&#34;k&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;string&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;fake_flag&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s&#34;&gt;&amp;#34;FakeCTF{***** REDUCTED *****}&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;span class=&#34;k&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;string&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;fake_enc_flag&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s&#34;&gt;&amp;#34;b99f9699b8aebf83dddcdfded9d2a3b5abbbaeb8aeaec9c2cdcccfce9e&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;

&lt;span class=&#34;kt&#34;&gt;uint8_t&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;read_byte&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;string&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;enc&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;uint32_t&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;idx&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
    &lt;span class=&#34;kt&#34;&gt;char&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;c1&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;enc&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;idx&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;];&lt;/span&gt;
    &lt;span class=&#34;kt&#34;&gt;char&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;c2&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;enc&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;idx&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;];&lt;/span&gt;
    &lt;span class=&#34;n&#34;&gt;string&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;s&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;string&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;c1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;c2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;};&lt;/span&gt;
    &lt;span class=&#34;kt&#34;&gt;uint8_t&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;stoi&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;s&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;nullptr&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;16&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
    &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;uint8_t&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;

&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;main&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
    &lt;span class=&#34;k&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;string&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;enc_flag_ref&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;enc_flag&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;

    &lt;span class=&#34;n&#34;&gt;vector&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;uint8_t&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;ans&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{};&lt;/span&gt;
    &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;uint32_t&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;enc_flag_ref&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;size&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;/&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;++&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
        &lt;span class=&#34;kt&#34;&gt;char&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;unenc&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
        &lt;span class=&#34;kt&#34;&gt;uint8_t&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;enc&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;read_byte&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;enc_flag_ref&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
        &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;char&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;c&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x00&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;c&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x7f&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;c&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;++&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
        &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
            &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;enc&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;==&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;((((&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;^&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;c&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;amp;&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0xff&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;|&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;uint32_t&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)(&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;uint32_t&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;c&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;7&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;8&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;^&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0xff&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;^&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;
            &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
                &lt;span class=&#34;n&#34;&gt;unenc&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;c&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
            &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
        &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
        &lt;span class=&#34;n&#34;&gt;ans&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;push_back&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;((&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;uint8_t&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;unenc&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
    &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;ans&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;size&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;++&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
        &lt;span class=&#34;n&#34;&gt;printf&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;%c&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;ans&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]);&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
    &lt;span class=&#34;n&#34;&gt;printf&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\n&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
    &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;上記の &lt;code&gt;solve.cpp&lt;/code&gt; をコンパイルし実行するとフラグゲットです。&lt;/p&gt;
&lt;p&gt;&lt;code&gt;CakeCTF{w3_n33d_t0_pr3v3nt_Google_fr0m_st4nd4rd1z1ng_ev3ryth1ng}&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;おしまい。&lt;/p&gt;
</description>
    </item>
    
    
    
    <item>
      <title>20220827</title>
      <link>https://hanazonochateau.net/posts/2022/08/28/20220827/</link>
      <pubDate>Sun, 28 Aug 2022 10:02:23 +0900</pubDate>
      
      <guid>https://hanazonochateau.net/posts/2022/08/28/20220827/</guid>
      <description>&lt;h2 id=&#34;花火をしました&#34;&gt;花火をしました&lt;/h2&gt;
&lt;p&gt;夏の終わりも近づいてきましたが、特に夏っぽいことをしていないなあと思っていたら、SNSでつながりのある方が「花火して、スイカ食べましょう」という提案をしてくださって、それはいいですねと盛り上がり、予定が確保され開催されることとなりました。&lt;/p&gt;
&lt;p&gt;集まったのは自分を含めて3人で、駅で集合し、花火を探すために自分の車でホームセンターに向かいました。
120本入りの少し大きめの花火とチャッカマンをカゴに入れ、あとは買うものはないですかと言うと、1人がレジ横にあったシャボン玉セットをひょいとカゴに入れました。
そういえばこの年になってシャボン玉を吹く機会ってないなと思い、少し新鮮な気持ちになりました。&lt;/p&gt;
&lt;p&gt;次にスーパーに向かい、スイカやビール、つまみのための食材などを買いました。
スイカはLサイズのものが一玉残っていて、せっかくなので大きいものを買おうと持ち上げようとしたら案外重く、8kgくらいはあるんじゃないかと思われました。
食べきれるのかどうかという問題が少し頭をよぎりましたが、ここで小さいものを買っても仕方がないと、エイヤとカゴに入れました。&lt;/p&gt;
&lt;p&gt;果物コーナーにはブドウも陳列されていて、中には自分の地元の種無し巨峰もありました。
巨峰なら食べたいということになり、一つ買っていくことになりました。
その他食材も買い込み、お酒も買おうとなりました。
自分は車を運転するためノンアルコールのものを買おうとしたら、常陸野ビールのノンアルコールのものが売られているのを一人が発見し、おいしそうだと教えてくれたのでそれを手に取りました。&lt;/p&gt;
&lt;p&gt;そうしてそれらを購入した後、自分の家が少し広めなのでそこでスイカを食べようとなり、車で自分の家まで戻りました。
一人が料理上手なのでつまみの作成を任せたら、フライパンで炒め物をこしらえてくれました。
鶏のささみとマッシュルーム、それとししとうをオリーブオイルで炒め、醤油と塩で味を整え、香草とにんにくで香りづけしてくれました。&lt;/p&gt;
&lt;p&gt;いい香りが漂ってきたところで、二人はビールのプルトップを開け、自分は常陸野ノンアルコールビールの瓶をこじ開け、乾杯しました。
自分の瓶からはノンアルコールのくせにクラフトビールみたいな立派な香りがしてきて、飲みごたえもビールと遜色なく、とてもおいしいものでした。
喉にノンアルコールのビールが通ったので、さてさてつまみを、と炒め物を食べてみると、これが大変おいしく、箸が進みました。
特においしかったのはししとうで、中の種がピリリと刺激的で鼻にツンと抜ける感じがよかったです。&lt;/p&gt;
&lt;p&gt;お酒を飲んだ後はまず巨峰を食べました。
最近はシャインマスカットが流行っていますが、なんだかんだ言って巨峰が一番好きな気がします。
自分は皮ごと食べ、ほかの二人は皮をむいて食べていました。
最後の方になってくると、皮ごと食べてたせいか口の中がちょっと渋くなりました。&lt;/p&gt;
&lt;p&gt;スイカはまず半分に割り、半分を半月状に四等分してそのうち三つを三人で食べました。
一人がスイカの中心部に近い部分を指して「ここはスイカのトロ」、中心部から少し外れた種のある部分を指して「ここはスイカの中落ち」と楽しそうに言っていました。
各々が切り分けられたスイカにかぶりつき、口の周りやテーブルの上をスイカ汁だらけにしながら、おいしくいただきました。&lt;/p&gt;
&lt;p&gt;お酒やスイカを堪能したら、さていよいよ花火をやろうということで、外に出て花火を行いました。
120本あったのでたくさんできるだろうと思っていたら、そのうち30本くらいは線香花火で、普通の手持ち花火は案外早く終わってしまったのが残念です。
途中で一人の服に大きめの虫が引っ付いて、何の虫だろうと見ようとしたのですが、花火の光をずっと眺めていたので、視界の中央が白く眩んでなんだかよくわかりませんでした。
自分だけかと思ったら他の二人もそのようで、おかしくなってみんなで笑いました。&lt;/p&gt;
&lt;p&gt;帰り道は誰もいなかったので、シャボン玉を吹きながら戻りました。
勢いよくストローを吹くとフワーとあたりにシャボン玉が広がって、なんだかメルヘンというか、童心に還ったというか、そんな感じになりました。&lt;/p&gt;
</description>
    </item>
    
    
    
    <item>
      <title>20220821</title>
      <link>https://hanazonochateau.net/posts/2022/08/21/20220821/</link>
      <pubDate>Sun, 21 Aug 2022 08:27:38 +0900</pubDate>
      
      <guid>https://hanazonochateau.net/posts/2022/08/21/20220821/</guid>
      <description>&lt;p&gt;最近は冷房に当たりまくりで、外に出るとアッという間に汗だくになります。
あと蚊に刺されまくっています。
昨日も外で車のメンテナンスをしていたら3箇所くらい刺されました。
痒いです。&lt;/p&gt;
&lt;p&gt;お盆がいつの間にか過ぎていたのでかなりびっくりしています。
8月前半はなかなか忙しくて旅行なども行けず、休日は家で寝ていることが多かったです。
寝ているといってもおそらく睡眠時無呼吸があり、そのせいで4時間くらいで起きてしまうので深い睡眠はあまりとれていない気がしています。&lt;/p&gt;
&lt;p&gt;最近は朝夕に関しては涼しい時もたまにあります。
そういうときは散歩に行ったりしています。
ヒグラシが鳴くくらいの気温で歩くと気分がリフレッシュできます。
気温が低くても湿度が高いときはあまり出歩きません。
汗が出てくるので。
早く秋になって、カラッとした空を見たいです。&lt;/p&gt;
&lt;p&gt;8月の残りにしたいことは以下の通りです。&lt;/p&gt;
&lt;h3 id=&#34;同人誌の原稿執筆&#34;&gt;同人誌の原稿執筆&lt;/h3&gt;
&lt;p&gt;知り合いが主催している合同誌にお邪魔しているのですが、その同人誌の締め切りが9月の頭なのでなんとか書き上げたいです。
まだネタ仕込みが終わっていないのですが、できるだけコンパクトにまとめて出したいと思っています。&lt;/p&gt;
&lt;h3 id=&#34;花火&#34;&gt;花火&lt;/h3&gt;
&lt;p&gt;この間SNSのフォロワーさんと花火をしたいねという会話をしたので、ホームセンターで手持ち花火を仕入れて数人くらいで花火をして夏を終わらせたいです。
特に線香花火で心を整えたいですね。&lt;/p&gt;
</description>
    </item>
    
    
    
    <item>
      <title>20220711</title>
      <link>https://hanazonochateau.net/posts/2022/07/11/20220711/</link>
      <pubDate>Mon, 11 Jul 2022 20:50:36 +0900</pubDate>
      
      <guid>https://hanazonochateau.net/posts/2022/07/11/20220711/</guid>
      <description>&lt;p&gt;最近やっていることを書こうかと思います。&lt;/p&gt;
&lt;h3 id=&#34;ドライブ&#34;&gt;ドライブ&lt;/h3&gt;
&lt;p&gt;夜な夜な家の周りを走っています。
納車から1000kmを突破し、そろそろ運転にも慣れてきました。
駐車はまだ少し斜めっていますが……&lt;/p&gt;
&lt;p&gt;この間の土日に洗車して、ついでにガラスコーティング剤をガラスに塗りました。
空を反射してとてもピカピカです。
ついでにエアコンガスも補充しました、キンキンに冷えた空気が出るようになりました。
これからの季節は暑いのでちょうどよかったです。&lt;/p&gt;
&lt;h3 id=&#34;作曲&#34;&gt;作曲&lt;/h3&gt;
&lt;p&gt;以前から作曲は何度も始めて何度も挫折しているのですが、今回は趣向を変えてハードウェアトラッカーを買ってみました。
&lt;a href=&#34;https://polyend.com/tracker/&#34;  target=&#34;_blank&#34; &gt;Polyend Tracker&lt;/a&gt;というトラッカーです。
10万円は痛かった……&lt;/p&gt;
&lt;p&gt;こいつはトラッカーというスタイルの作曲ソフトをハードウェアでできるようにしたものです。
とりあえずこいつで何曲か作ってみました。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://soundcloud.com/totsugekitai/master&#34;  target=&#34;_blank&#34; &gt;master&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://soundcloud.com/totsugekitai/big-burn&#34;  target=&#34;_blank&#34; &gt;big burn&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://soundcloud.com/totsugekitai/sdm&#34;  target=&#34;_blank&#34; &gt;sdm&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://soundcloud.com/totsugekitai/emacs&#34;  target=&#34;_blank&#34; &gt;emacs&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;最初は使いづらく感じましたが、一通り操作方法を理解し、手になじんできたような気がします。
まあうまく作曲できるかどうかは別問題ですが……
継続していきたいですね。&lt;/p&gt;
&lt;h3 id=&#34;パソ&#34;&gt;パソ&lt;/h3&gt;
&lt;p&gt;趣味パソはあんまりできていません。
上記2つのことで手一杯なので、しばらくお休みかな。
労働パソはあるので手がなまることはないでしょう。&lt;/p&gt;
</description>
    </item>
    
    
    
    <item>
      <title>SECCON Beginners CTF 2022 参加記 &amp; Writeup</title>
      <link>https://hanazonochateau.net/posts/2022/06/06/ctf4b2022/</link>
      <pubDate>Mon, 06 Jun 2022 20:17:45 +0900</pubDate>
      
      <guid>https://hanazonochateau.net/posts/2022/06/06/ctf4b2022/</guid>
      <description>&lt;h1 id=&#34;ctf4bに参加しました&#34;&gt;ctf4bに参加しました&lt;/h1&gt;
&lt;p&gt;6月の4,5日に開催されたSECCON Beginners CTF 2022にチーム &lt;a href=&#34;https://dcdcnation.com/&#34;  target=&#34;_blank&#34; &gt;DCDC&lt;/a&gt; の一員として参加しました。
その中でrevのWinTLSとRansomを解きました。&lt;/p&gt;
&lt;h2 id=&#34;まずは感想&#34;&gt;まずは感想&lt;/h2&gt;
&lt;p&gt;初めてのCTFでしたが、解きごたえがあり大変楽しくプレイできたと思います。&lt;/p&gt;
&lt;p&gt;実際に満足する程解けたかというと、チームメンバーが怒涛の勢いで解いてて、それについていくので精一杯でした。
revやpwnのhard問題まで解けるように精進したいです。&lt;/p&gt;
&lt;h2 id=&#34;writeup&#34;&gt;Writeup&lt;/h2&gt;
&lt;p&gt;自分が解いたrevのWinTLSとRansomの解説をしたいと思います。&lt;/p&gt;
&lt;h3 id=&#34;wintls&#34;&gt;WinTLS&lt;/h3&gt;
&lt;p&gt;PEバイナリが与えられます。
Windowsで実行すると、テキストボックスとボタンがあるウィンドウが表示され、フラグを入力してボタンを押すと正しいか間違っているか教えてくれます。&lt;/p&gt;
&lt;p&gt;とりあえずGhidraに食わせてみると &lt;code&gt;main&lt;/code&gt; 関数内に &lt;code&gt;WndProc&lt;/code&gt; があったのでそれをクリック。&lt;/p&gt;
&lt;p&gt;&lt;code&gt;WndProc&lt;/code&gt; に設定されているプログラムはこんな感じ。&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span class=&#34;n&#34;&gt;LRESULT&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;UndefinedFunction_004018f9&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;HWND&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;param_1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;uint&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;param_2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;WPARAM&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;param_3&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;longlong&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;param_4&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;

    &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;省略&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;

    &lt;span class=&#34;n&#34;&gt;pvStack16&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;CreateThread&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;((&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;LPSECURITY_ATTRIBUTES&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0x0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;LPTHREAD_START_ROUTINE&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;t1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;atStack312&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
                             &lt;span class=&#34;o&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;DStack36&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
    &lt;span class=&#34;n&#34;&gt;pvStack24&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;CreateThread&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;((&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;LPSECURITY_ATTRIBUTES&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0x0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;LPTHREAD_START_ROUTINE&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;t2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;atStack312&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
                             &lt;span class=&#34;o&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;DStack36&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
    &lt;span class=&#34;n&#34;&gt;WaitForSingleObject&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;pvStack16&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0xffffffff&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
    &lt;span class=&#34;n&#34;&gt;WaitForSingleObject&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;pvStack24&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0xffffffff&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
    &lt;span class=&#34;n&#34;&gt;GetExitCodeThread&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;pvStack16&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;DStack40&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
    &lt;span class=&#34;n&#34;&gt;GetExitCodeThread&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;pvStack16&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;DStack44&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
    &lt;span class=&#34;n&#34;&gt;CloseHandle&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;pvStack16&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
    &lt;span class=&#34;n&#34;&gt;CloseHandle&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;pvStack24&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
    &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;((&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;DStack40&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;==&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;DStack44&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;==&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
      &lt;span class=&#34;n&#34;&gt;MessageBoxA&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;((&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;HWND&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0x0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;Correct flag!&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;DOPE&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0x40&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
    &lt;span class=&#34;k&#34;&gt;else&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
      &lt;span class=&#34;n&#34;&gt;MessageBoxA&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;((&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;HWND&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0x0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;Wrong flag...&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;NOPE&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0x10&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
    &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;

  &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;省略&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;

&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;code&gt;CreateThread&lt;/code&gt; で &lt;code&gt;t1&lt;/code&gt; と &lt;code&gt;t2&lt;/code&gt; というスレッドを作り、ExitCodeが両方とも0だったら正しいフラグのようです。&lt;/p&gt;
&lt;p&gt;&lt;code&gt;t1&lt;/code&gt; を見てみます。&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span class=&#34;kt&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;UndefinedFunction_0040159d&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;longlong&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;param_1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
  &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;省略&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
  &lt;span class=&#34;n&#34;&gt;TlsSetValue&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;TLS&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;c4{fAPu8#FHh2+0cyo8$SWJH3a8X&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
  &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;uStack16&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
      &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;uStack16&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x100&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;cStack17&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;char&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;param_1&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;uStack16&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;cStack17&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;!=&lt;/span&gt; &lt;span class=&#34;sc&#34;&gt;&amp;#39;\0&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;));&lt;/span&gt;
      &lt;span class=&#34;n&#34;&gt;uStack16&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;uStack16&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
    &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(((&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;uStack16&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;%&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;3&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;==&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;||&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;((&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;uStack16&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;%&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;5&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;==&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;// 3 or 5で割り切れるとき
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;      &lt;span class=&#34;n&#34;&gt;lVar1&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;longlong&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;iStack12&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
      &lt;span class=&#34;n&#34;&gt;iStack12&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;iStack12&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
      &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;char&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)((&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;longlong&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;uStack280&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;lVar1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;cStack17&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
  &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
  &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;undefined&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)((&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;longlong&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;uStack280&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;longlong&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;iStack12&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
  &lt;span class=&#34;n&#34;&gt;check&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;((&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;char&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;uStack280&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
  &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;code&gt;t2&lt;/code&gt; も見てみます。&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span class=&#34;kt&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;UndefinedFunction_004017d1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;longlong&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;param_1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
  &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;省略&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
  &lt;span class=&#34;n&#34;&gt;TlsSetValue&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;TLS&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;tfb%s$T9NvFyroLh@89a9yoC3rPy&amp;amp;3b}&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
  &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;uStack16&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
      &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;uStack16&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x100&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;cStack17&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;char&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;param_1&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;uStack16&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;cStack17&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;!=&lt;/span&gt; &lt;span class=&#34;sc&#34;&gt;&amp;#39;\0&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;));&lt;/span&gt;
      &lt;span class=&#34;n&#34;&gt;uStack16&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;uStack16&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
    &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(((&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;uStack16&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;%&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;3&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;!=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;((&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;uStack16&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;%&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;5&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;!=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;// 3で割り切れない and 5で割り切れない
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;      &lt;span class=&#34;n&#34;&gt;lVar1&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;longlong&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;iStack12&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
      &lt;span class=&#34;n&#34;&gt;iStack12&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;iStack12&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
      &lt;span class=&#34;n&#34;&gt;acStack280&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;lVar1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;cStack17&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
  &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
  &lt;span class=&#34;n&#34;&gt;acStack280&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;iStack12&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;sc&#34;&gt;&amp;#39;\0&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
  &lt;span class=&#34;n&#34;&gt;check&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;acStack280&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
  &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;code&gt;t1&lt;/code&gt; ではインデックスが3か5で割り切れるときに &lt;code&gt;uStack280&lt;/code&gt; にデータを格納、&lt;code&gt;t2&lt;/code&gt; ではインデックスが3でも5でも割り切れないときに &lt;code&gt;acStack280&lt;/code&gt; にデータを格納しています。
そしてどちらとも関数上部で &lt;code&gt;TlsSetValue&lt;/code&gt; に怪しい文字列をセットしています。&lt;/p&gt;
&lt;p&gt;なんとなくこのTLSにセットしている文字列を並び変えればいいのだなと思い、メモ帳開いてせっせと並び変えました。&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;*     *   * *     *  *     *        *        *     *  *        *  *     *        *        *     *  *        *  *     *        *        *     *  *        *  *     * 
0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60
c     4   { f     A  P     u        8        #     F  H        h  2     +        0        c     y  o        8  $     S        W        J     H  3        a  8     X
  t f   b     % s       $     T  9     N  v     F        y  r        o     L  h     @  8     9        a  9        y     o  C     3  r     P        y  &amp;amp;        3     b  }

ctf4b{f%sAP$uT98Nv#FFHyrh2o+Lh0@8c9yoa98$ySoCW3rJPH3y&amp;amp;a83Xb}
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;ナルホディウス。&lt;/p&gt;
&lt;p&gt;これをテキストボックスに入れてみるとOKっぽい。
ということでこれがフラグです。&lt;/p&gt;
&lt;h3 id=&#34;ransom&#34;&gt;Ransom&lt;/h3&gt;
&lt;p&gt;この問題の暗号化方式はRC4ってやつらしいですね、前にも見たことがあったので見抜けなかったのは痛い。
バイナリと暗号化されたテキストファイル、pcapファイルが渡され、テキストファイルを復号化するとフラグが手に入ります。&lt;/p&gt;
&lt;p&gt;Ghidraくんに食わせて見やすいように変数名とか書き換えたのがこちら。&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;main&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;void&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;

&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
  &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;省略&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
  &lt;span class=&#34;n&#34;&gt;random_buf&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;char&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;malloc&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0x11&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
  &lt;span class=&#34;n&#34;&gt;random_init&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0x10&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;random_buf&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
  &lt;span class=&#34;n&#34;&gt;originfs&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;fopen&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;ctf4b_super_secret.txt&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;r&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
  &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;originfs&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;==&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;FILE&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0x0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
    &lt;span class=&#34;n&#34;&gt;puts&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;Can&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\&amp;#39;&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;t open file.&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
    &lt;span class=&#34;n&#34;&gt;iVar1&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
  &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
  &lt;span class=&#34;k&#34;&gt;else&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
    &lt;span class=&#34;n&#34;&gt;pcVar3&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;fgets&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;flag_contents&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0x100&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;originfs&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
    &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;pcVar3&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;!=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;char&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0x0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
      &lt;span class=&#34;n&#34;&gt;flag_len&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;strlen&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;flag_contents&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
      &lt;span class=&#34;n&#34;&gt;crypted_buf&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;char&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;malloc&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;flag_len&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
      &lt;span class=&#34;n&#34;&gt;lock_file&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;random_buf&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;flag_contents&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,(&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;long&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;crypted_buf&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
      &lt;span class=&#34;n&#34;&gt;lockf&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;fopen&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;ctf4b_super_secret.txt.lock&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;w&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
      &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;lockf&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;==&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;FILE&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0x0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
        &lt;span class=&#34;n&#34;&gt;puts&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;Can&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\&amp;#39;&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;t write file.&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
        &lt;span class=&#34;n&#34;&gt;iVar1&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
        &lt;span class=&#34;k&#34;&gt;goto&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;LAB_0010191f&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
      &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
      &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
      &lt;span class=&#34;k&#34;&gt;while&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;true&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
        &lt;span class=&#34;n&#34;&gt;flag_len&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;strlen&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;flag_contents&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
        &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;==&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;flag_len&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;break&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
        &lt;span class=&#34;n&#34;&gt;fprintf&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;lockf&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\\&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;x%02x&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ulong&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;byte&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;crypted_buf&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]);&lt;/span&gt;
        &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
      &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
      &lt;span class=&#34;n&#34;&gt;fclose&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;lockf&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
    &lt;span class=&#34;n&#34;&gt;fclose&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;originfs&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
    &lt;span class=&#34;n&#34;&gt;iVar1&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;socket&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
    &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;iVar1&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
      &lt;span class=&#34;n&#34;&gt;perror&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;Failed to create socket&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
      &lt;span class=&#34;n&#34;&gt;iVar1&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
    &lt;span class=&#34;k&#34;&gt;else&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
      &lt;span class=&#34;n&#34;&gt;local_128&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;_0_2_&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
      &lt;span class=&#34;n&#34;&gt;local_124&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;inet_addr&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;192.168.0.225&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
      &lt;span class=&#34;n&#34;&gt;local_128&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;_2_2_&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;htons&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0x1f90&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
      &lt;span class=&#34;n&#34;&gt;iVar2&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;connect&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;iVar1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sockaddr&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;local_128&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0x10&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
      &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;iVar2&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;==&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
        &lt;span class=&#34;n&#34;&gt;write&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;iVar1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;random_buf&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0x11&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
        &lt;span class=&#34;n&#34;&gt;iVar1&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
      &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
      &lt;span class=&#34;k&#34;&gt;else&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
        &lt;span class=&#34;n&#34;&gt;perror&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;Failed to connect&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
        &lt;span class=&#34;n&#34;&gt;iVar1&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
      &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
  &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
  &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;省略&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
  &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;iVar1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;フラグが書かれたデータをファイルに読み込み、暗号化し、 &lt;code&gt;.lock&lt;/code&gt; ファイルに書き込んでいます。
後半部では、乱数で生成した鍵を外部に送信していますね。&lt;/p&gt;
&lt;p&gt;pcapファイルを覗くと鍵が手に入ったので、これを使って何とかします。&lt;/p&gt;
&lt;p&gt;&lt;code&gt;lock_file&lt;/code&gt; 関数の中身はこうなっています。&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span class=&#34;n&#34;&gt;undefined8&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;lock_file&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;char&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;random_buf&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;char&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;flag_contents&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;long&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;crypted_buf&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
  &lt;span class=&#34;kt&#34;&gt;long&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;in_FS_OFFSET&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
  &lt;span class=&#34;kt&#34;&gt;char&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;local_118&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;264&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;];&lt;/span&gt;
  &lt;span class=&#34;kt&#34;&gt;long&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;local_10&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
  
  &lt;span class=&#34;n&#34;&gt;local_10&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;long&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;in_FS_OFFSET&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x28&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
  &lt;span class=&#34;n&#34;&gt;random_set&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;random_buf&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;local_118&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
  &lt;span class=&#34;n&#34;&gt;encrypt&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;local_118&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;flag_contents&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,(&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;char&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;crypted_buf&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
  &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;local_10&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;!=&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;long&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;in_FS_OFFSET&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x28&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
                    &lt;span class=&#34;cm&#34;&gt;/* WARNING: Subroutine does not return */&lt;/span&gt;
    &lt;span class=&#34;n&#34;&gt;__stack_chk_fail&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;
  &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
  &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;code&gt;local_118&lt;/code&gt; に乱数で生成した鍵をセットし、それを用いて &lt;code&gt;encrypt&lt;/code&gt; 関数でファイルを暗号化します。&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span class=&#34;n&#34;&gt;undefined8&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;encrypt&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;char&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;local_118&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;char&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;flag_contents&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;char&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;crypted_buf&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
  &lt;span class=&#34;n&#34;&gt;size_t&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;flag_len&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
  &lt;span class=&#34;n&#34;&gt;uint&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;local_24&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
  &lt;span class=&#34;n&#34;&gt;uint&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;local_20&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
  &lt;span class=&#34;n&#34;&gt;ulong&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
  
  &lt;span class=&#34;n&#34;&gt;local_24&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
  &lt;span class=&#34;n&#34;&gt;local_20&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
  &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
  &lt;span class=&#34;n&#34;&gt;flag_len&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;strlen&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;flag_contents&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
  &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;flag_len&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
    &lt;span class=&#34;n&#34;&gt;local_24&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;local_24&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;amp;&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0xff&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
    &lt;span class=&#34;n&#34;&gt;local_20&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;byte&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;local_118&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[(&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;local_24&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;local_20&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;amp;&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0xff&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
    &lt;span class=&#34;n&#34;&gt;swap&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;local_118&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;local_24&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;local_118&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;local_20&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
    &lt;span class=&#34;n&#34;&gt;crypted_buf&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;
         &lt;span class=&#34;n&#34;&gt;flag_contents&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;^&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;local_118&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;byte&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;local_118&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[(&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;local_20&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;local_118&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[(&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;local_24&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;])];&lt;/span&gt;
  &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
  &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;code&gt;encrypt&lt;/code&gt; では色々複雑なことをしていますが、最後がXORを取っているだけなので、もう一回XORしなおせば元の内容が復元できます。
自分はRC4だと知らなかったので、C言語で再実装して実験をしました。&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span class=&#34;cp&#34;&gt;#include&lt;/span&gt; &lt;span class=&#34;cpf&#34;&gt;&amp;lt;stdio.h&amp;gt;&lt;/span&gt;&lt;span class=&#34;cp&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;cp&#34;&gt;#include&lt;/span&gt; &lt;span class=&#34;cpf&#34;&gt;&amp;lt;stdlib.h&amp;gt;&lt;/span&gt;&lt;span class=&#34;cp&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;cp&#34;&gt;#include&lt;/span&gt; &lt;span class=&#34;cpf&#34;&gt;&amp;lt;time.h&amp;gt;&lt;/span&gt;&lt;span class=&#34;cp&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;cp&#34;&gt;#include&lt;/span&gt; &lt;span class=&#34;cpf&#34;&gt;&amp;lt;string.h&amp;gt;&lt;/span&gt;&lt;span class=&#34;cp&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;cp&#34;&gt;#include&lt;/span&gt; &lt;span class=&#34;cpf&#34;&gt;&amp;lt;stdint.h&amp;gt;&lt;/span&gt;&lt;span class=&#34;cp&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;cp&#34;&gt;&lt;/span&gt;
&lt;span class=&#34;kt&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;random_init&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;char&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;buf&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
    &lt;span class=&#34;n&#34;&gt;time_t&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;t&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;time&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;NULL&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
    &lt;span class=&#34;n&#34;&gt;srand&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
    &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;++&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
        &lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;r&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;rand&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;
        &lt;span class=&#34;n&#34;&gt;buf&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s&#34;&gt;&amp;#34;0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;r&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;%&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x3e&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;];&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
    &lt;span class=&#34;n&#34;&gt;buf&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;sc&#34;&gt;&amp;#39;\0&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;

&lt;span class=&#34;kt&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;swap&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;char&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;char&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;b&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
    &lt;span class=&#34;kt&#34;&gt;char&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;tmpc&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
    &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;a&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;b&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
    &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;b&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;tmpc&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;

&lt;span class=&#34;kt&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;random_set&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;char&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;random_buf&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;char&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;buf&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
    &lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;random_buf_len&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;strlen&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;random_buf&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
    &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x100&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;++&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
        &lt;span class=&#34;n&#34;&gt;buf&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;char&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;

    &lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;l18&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
    &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x100&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;++&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
        &lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i2&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;uint32_t&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)(&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;uint8_t&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;buf&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;l18&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;random_buf&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;%&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;random_buf_len&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;];&lt;/span&gt;
        &lt;span class=&#34;kt&#34;&gt;uint32_t&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;u1&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;uint32_t&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i2&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x1f&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x18&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
        &lt;span class=&#34;n&#34;&gt;l18&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i2&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;u1&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;amp;&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0xff&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;u1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
        &lt;span class=&#34;n&#34;&gt;swap&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;buf&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;],&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;buf&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;l18&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]);&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;

&lt;span class=&#34;kt&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;encrypt&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;char&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;buf&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;char&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;flag_contents&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;char&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;crypted_buf&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
    &lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;flag_len&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;strlen&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;flag_contents&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
    &lt;span class=&#34;kt&#34;&gt;uint32_t&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;l24&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;l20&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
    &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;flag_len&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;++&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
        &lt;span class=&#34;n&#34;&gt;l24&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;l24&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;amp;&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0xff&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
        &lt;span class=&#34;n&#34;&gt;l20&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;uint8_t&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;buf&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[(&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;l24&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;l20&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;amp;&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0xff&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
        &lt;span class=&#34;n&#34;&gt;swap&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;buf&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[(&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;l24&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;],&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;buf&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[(&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;l20&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]);&lt;/span&gt;
        &lt;span class=&#34;n&#34;&gt;crypted_buf&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;flag_contents&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;^&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;buf&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[(&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;uint8_t&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;buf&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[(&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;l20&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;buf&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[(&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;l24&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;])];&lt;/span&gt;
        &lt;span class=&#34;kt&#34;&gt;char&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;lock_file_contents&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\x2b\xa9\xf3\x6f\xa2\x2e\xcd\xf3\x78\xcc\xb7\xa0\xde\x6d\xb1\xd4\x24\x3c\x8a\x89\xa3\xce\xab\x30\x7f\xc2\xb9\x0c\xb9\xf4\xe7\xda\x25\xcd\xfc\x4e\xc7\x9e\x7e\x43\x2b\x3b\xdc\x09\x80\x96\x95\xf6\x76\x10&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
        &lt;span class=&#34;kt&#34;&gt;char&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;f&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;lock_file_contents&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;^&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;buf&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[(&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;uint8_t&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;buf&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[(&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;l20&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;buf&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[(&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;l24&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;])];&lt;/span&gt;
        &lt;span class=&#34;n&#34;&gt;printf&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;%c&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;f&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;

&lt;span class=&#34;kt&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;lock_file&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;char&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;random_buf&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;char&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;flag_contents&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;char&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;crypted_buf&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
    &lt;span class=&#34;kt&#34;&gt;char&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;buf&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;264&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;};&lt;/span&gt;
    &lt;span class=&#34;n&#34;&gt;random_set&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;random_buf&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;buf&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
    &lt;span class=&#34;n&#34;&gt;encrypt&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;buf&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;flag_contents&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;crypted_buf&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;

&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;main&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;argc&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;char&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;argv&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[])&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
    &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;argc&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;!=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
        &lt;span class=&#34;n&#34;&gt;fprintf&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;stderr&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;s&#34;&gt;&amp;#34;usage: ./ransom_rev &amp;lt;flag&amp;gt;&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\n&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
        &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
    &lt;span class=&#34;kt&#34;&gt;char&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;input_flag&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;argv&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;];&lt;/span&gt;
    &lt;span class=&#34;kt&#34;&gt;char&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;random_buf&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;char&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;malloc&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0x11&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;

    &lt;span class=&#34;c1&#34;&gt;// random_init(0x10, random_buf);
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;
    &lt;span class=&#34;n&#34;&gt;random_buf&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s&#34;&gt;&amp;#34;rgUAvvyfyApNPEYg&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;

    &lt;span class=&#34;kt&#34;&gt;char&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;flag_contents&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;264&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;};&lt;/span&gt;
    &lt;span class=&#34;n&#34;&gt;snprintf&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;flag_contents&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x100&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;input_flag&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;

    &lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;flag_len&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;strlen&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;flag_contents&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
    &lt;span class=&#34;kt&#34;&gt;char&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;crypted_buf&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;char&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;malloc&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;flag_len&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
    &lt;span class=&#34;n&#34;&gt;lock_file&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;random_buf&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;flag_contents&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;crypted_buf&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
    &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;flag_len&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;++&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
        &lt;span class=&#34;n&#34;&gt;fprintf&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;stdout&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;s&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\\&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;x%02x&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;uint8_t&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;crypted_buf&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]);&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;code&gt;encrypt&lt;/code&gt; 内部で暗号化データをもう一回同じXORをとって復号してprintfしてやると、次のフラグがゲットできました。&lt;/p&gt;
&lt;p&gt;&lt;code&gt;ctf4b{rans0mw4re_1s_v4ry_dan9er0u3_s0_b4_c4refu1}&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;ポイントとしては、符号に気を付けることが挙げられます。
Ghidraのbyte型はuint8_tとして処理をしてあげると良いでしょう。&lt;/p&gt;
</description>
    </item>
    
    
    
    <item>
      <title>車を買いました</title>
      <link>https://hanazonochateau.net/posts/2022/05/25/car/</link>
      <pubDate>Wed, 25 May 2022 00:15:21 +0900</pubDate>
      
      <guid>https://hanazonochateau.net/posts/2022/05/25/car/</guid>
      <description>&lt;p&gt;題名の通り、車を買いました。
中古の日産サニーEXサルーン5MTです。&lt;/p&gt;
&lt;h2 id=&#34;日産サニーを買った理由&#34;&gt;日産サニーを買った理由&lt;/h2&gt;
&lt;p&gt;日産サニーを買った理由は単純で、デザインが好みだったからです。
セダン、好きなんですよね。
微妙にレトロで四角い感じが良いです。&lt;/p&gt;
&lt;p&gt;日産車を選んだ理由は、友人から日産の901運動の話を聞いたからです。
日産の技術に真摯な姿勢にオタク心を掴まれました。
まあ自分の買ったサニーは901運動が衰退した後に製造されたものですが……&lt;/p&gt;
&lt;p&gt;あと値段がお手頃だったというのもあります。
流石にまだお金がないので。&lt;/p&gt;
&lt;h2 id=&#34;なんでmtなのか&#34;&gt;なんでMTなのか&lt;/h2&gt;
&lt;p&gt;なぜMT車を選んだかというと、自分の持っている免許がMTも運転できるものだったからです。
せっかくMTが運転できるならMTを運転しようということで、日産の、MTで、デザインが好みの車を探しました。&lt;/p&gt;
&lt;h2 id=&#34;運転してみて&#34;&gt;運転してみて&lt;/h2&gt;
&lt;p&gt;初心者でも運転しやすい、ベーシックなファミリーカーだと思います。
免許取って以来1年半運転してなかった自分が普通に運転できているので。
2速でけっこうもっていけます。&lt;/p&gt;
&lt;p&gt;あと普通に運転って楽しいですね。
ギアチェンジとかガチャガチャやるのが適度にゲーム性があって飽きません。&lt;/p&gt;
&lt;h2 id=&#34;車を買ってびっくりしたこと&#34;&gt;車を買ってびっくりしたこと&lt;/h2&gt;
&lt;p&gt;任意保険の保険料が大変高いことに驚きました。
早く等級が上がってほしいです。&lt;/p&gt;
&lt;h2 id=&#34;心がけたいこと&#34;&gt;心がけたいこと&lt;/h2&gt;
&lt;p&gt;無事故・無違反の運転を心がけたいです。&lt;/p&gt;
</description>
    </item>
    
    
    
    <item>
      <title>友人から教えてもらった最高にうまいゆで卵の作り方</title>
      <link>https://hanazonochateau.net/posts/2022/05/12/boiled_egg/</link>
      <pubDate>Thu, 12 May 2022 22:07:24 +0900</pubDate>
      
      <guid>https://hanazonochateau.net/posts/2022/05/12/boiled_egg/</guid>
      <description>&lt;p&gt;こんにちは、唐突ですが今回はゆで卵の作り方について書きたいと思います。&lt;/p&gt;
&lt;h2 id=&#34;経緯&#34;&gt;経緯&lt;/h2&gt;
&lt;p&gt;今回書くゆで卵の作り方は、友人に教わったものです。
友人A君はゆで卵を作るのが大変うまいのですが、今日はA君がゆで卵の作り方を教えてくれました。&lt;/p&gt;
&lt;p&gt;ちなみに「フライパン　ゆで卵」で検索すると出てくるレシピらしいです。&lt;/p&gt;
&lt;h2 id=&#34;肝心の作り方&#34;&gt;肝心の作り方&lt;/h2&gt;
&lt;p&gt;肝心のゆで卵の作り方です。&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;フライパンに水を1cmくらいの深さまで入れる&lt;/li&gt;
&lt;li&gt;卵を入れ、ふたをして火にかけて沸騰するまで待つ&lt;/li&gt;
&lt;li&gt;沸騰したら弱火にして4分保つ(ふたしたまま)&lt;/li&gt;
&lt;li&gt;火を消して4～5分余熱で熱する(ふたしたまま)&lt;/li&gt;
&lt;li&gt;流水で冷やして出来上がり&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;4番の余熱で熱する部分は、最初は5分から始めて、感覚をつかめたらお好みのかたさを狙っていくと良いでしょう。
今日は5分で行いましたが、完熟よりの半熟でおいしかったです。&lt;/p&gt;
&lt;h2 id=&#34;栄養素について&#34;&gt;栄養素について&lt;/h2&gt;
&lt;p&gt;ゆで卵はビタミンEを豊富に含むそうです。
ビタミンEは脂溶性で、抗酸化作用があり、血管を健康に保つらしいです。&lt;/p&gt;
&lt;p&gt;なるほど、みんなも食べましょう。&lt;/p&gt;
</description>
    </item>
    
    
    
    <item>
      <title>20220503</title>
      <link>https://hanazonochateau.net/posts/2022/05/03/20220503/</link>
      <pubDate>Tue, 03 May 2022 22:56:24 +0900</pubDate>
      
      <guid>https://hanazonochateau.net/posts/2022/05/03/20220503/</guid>
      <description>&lt;p&gt;特に書くことがなかったので更新をしなかったら「更新しないの？」と知り合いに言われたので、近況でも書こうと思います。
新年度も早1ヶ月が過ぎ、ゴールデンウィークの真っ最中です。
自分のゴールデンウィークはというと、帰省をして自分が通っていた高校がある町を探索しました。
避暑地として有名な観光名所を有する市で、水と風景が綺麗な良い土地です。&lt;/p&gt;
&lt;p&gt;電車を乗り継いで1時間、まず温泉に入りに行きました。
内風呂と外風呂が1つずつの、そこまで大きくない温泉です。
その日は晴天で日差しが強く、歩いていると少し汗ばむが、風は涼しくて気持ちいいくらいの気温でした。
温泉は湯加減が40度前後で、前述した気温になじんでいて大変気持ちよかったです。
また遠くに名山が見え、気分も晴れ晴れしました。
風呂上がりに飲んだビン牛乳が美味しかったです。&lt;/p&gt;
&lt;p&gt;その後は近くにある湧水公園まで、1駅分歩いて移動しました。
田舎の1駅なので当然6kmくらいあり、結局1時間くらいかかってしまいました。
道中には避暑地らしく別荘地や美術館などがあり、綺麗に刈り込まれた芝や樹木を見て感心しました。
歩いていると涼風が身体を通り抜けていき、汗も気にならない感じでした。&lt;/p&gt;
&lt;p&gt;湧水公園では、水を触って冷たさに驚いたり、四阿で風にあたりながらボーっとしたりしました。
ここまで歩いて疲れたので、帰りは最寄り駅までタクシーを使いましたが、けっこう料金がかかってびっくりしました。&lt;/p&gt;
&lt;p&gt;こんな感じで、まあまあ満喫できたと思います。
GW後半は何をしようかな。&lt;/p&gt;
</description>
    </item>
    
    
    
    <item>
      <title>春から働きます</title>
      <link>https://hanazonochateau.net/posts/2022/03/28/new_shakai_human/</link>
      <pubDate>Mon, 28 Mar 2022 06:36:18 +0900</pubDate>
      
      <guid>https://hanazonochateau.net/posts/2022/03/28/new_shakai_human/</guid>
      <description>&lt;p&gt;飽きて放置していたので久しぶりの更新になります。
近況と春からのことについて書きたいと思います。&lt;/p&gt;
&lt;h1 id=&#34;大学&#34;&gt;大学&lt;/h1&gt;
&lt;p&gt;実はまだ卒業していません。&lt;/p&gt;
&lt;p&gt;1年生の際に3ヶ月だけ休学をはさんでいたので、在学年数が足りず9月卒業になりました。
なのであと半年学生をやります。
T大学の皆さんよろしくお願いします。&lt;/p&gt;
&lt;h1 id=&#34;就職&#34;&gt;就職&lt;/h1&gt;
&lt;p&gt;4月から新社会人として東京のIT企業で働きます。&lt;/p&gt;
&lt;p&gt;あれ？学生やるんじゃないの？って思うでしょうが、もう単位は取りきっているので、実は9月までの間、無の学生です。
就職先にそのことを話したら、普通に4月から働いてもらっても構わないと言ってくれました。
なので4/1からフルタイム労働者です。&lt;/p&gt;
&lt;p&gt;ITの中でも今までやってきていないジャンルのことが出来そうなので、不安半分期待半分といったところです。
エンジニアの皆さんよろしくお願いします。&lt;/p&gt;
&lt;h1 id=&#34;生活&#34;&gt;生活&lt;/h1&gt;
&lt;p&gt;しばらくは大学周辺で暮らしたいと思います。&lt;/p&gt;
&lt;p&gt;あれ？東京で働くんじゃないの？って思うでしょうが、就職先はリモートワークが可能なのです。
引っ越すのも面倒だし、家賃も東京に比べれば安いので、このまま今の賃貸に住み続けたいと思います。&lt;/p&gt;
&lt;p&gt;今まで実家にあった住民票も移しました。
T市の皆さんよろしくお願いします。&lt;/p&gt;
&lt;h1 id=&#34;やりたいこと&#34;&gt;やりたいこと&lt;/h1&gt;
&lt;p&gt;4月からやりたいこと一覧です。&lt;/p&gt;
&lt;h3 id=&#34;車を買いたい&#34;&gt;車を買いたい&lt;/h3&gt;
&lt;p&gt;そろそろ教習所でやったことを忘れそうなので、車を買って乗り回したいです。
また、現在住んでいる場所は都会とはいいがたいので、車がないといろいろ不便でもあるので。&lt;/p&gt;
&lt;h3 id=&#34;痩せたい&#34;&gt;痩せたい&lt;/h3&gt;
&lt;p&gt;大学生活で散々太ったのでそろそろ痩せたいです。
というかリモートワークなので意識的に運動しないとやばいです。
毎朝散歩orジョギングを心がけます。&lt;/p&gt;
&lt;h1 id=&#34;という感じです&#34;&gt;という感じです&lt;/h1&gt;
&lt;p&gt;死ぬまではなんとか社会を生き抜いていきたいですね。&lt;/p&gt;
&lt;p&gt;皆さんからのお祝いよろしくお願いします。&lt;/p&gt;
</description>
    </item>
    
    
    
    <item>
      <title>/proc/$pid/pagemapを読みたいときにハマったポイント</title>
      <link>https://hanazonochateau.net/posts/2022/02/18/proc-pid-pagemap/</link>
      <pubDate>Fri, 18 Feb 2022 22:28:36 +0900</pubDate>
      
      <guid>https://hanazonochateau.net/posts/2022/02/18/proc-pid-pagemap/</guid>
      <description>&lt;p&gt;linuxでは &lt;code&gt;/proc/$pid/pagemap&lt;/code&gt; でプロセスの仮想メモリ領域がどのように物理メモリにマップされているかを調べることができます。
しかし、いくつか注意しないと正確に読めないのでそれについて解説します。&lt;/p&gt;
&lt;h1 id=&#34;データはバイナリ形式で読み出す必要がある&#34;&gt;データはバイナリ形式で読み出す必要がある&lt;/h1&gt;
&lt;p&gt;普通に &lt;code&gt;cat /proc/self/pagemap&lt;/code&gt; とかやっても読み出すことはできません。
このファイルはバイナリファイルで、ルールに従ってバイナリを読みださなければいけません。&lt;/p&gt;
&lt;p&gt;ルールは &lt;a href=&#34;https://github.com/torvalds/linux/blob/v4.9/Documentation/vm/pagemap.txt&#34;  target=&#34;_blank&#34; &gt;pagemap.txt&lt;/a&gt; に書かれています。
8バイトずつ読み出します。
Bits 0-54が物理ページのフレーム番号です。&lt;/p&gt;
&lt;h1 id=&#34;seekして正しい位置から読み出す&#34;&gt;seekして正しい位置から読み出す&lt;/h1&gt;
&lt;p&gt;正しいオフセットから &lt;code&gt;read&lt;/code&gt; しないといけません。
オフセットの計算は次のように行います。
&lt;a href=&#34;https://mmi.hatenablog.com/entry/2017/05/01/215921&#34;  target=&#34;_blank&#34; &gt;仮想アドレスから物理アドレスを求める&lt;/a&gt;から必要な部分を抜粋します。&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span class=&#34;kt&#34;&gt;unsigned&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;long&lt;/span&gt;
&lt;span class=&#34;nf&#34;&gt;virt2phy&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;virtaddr&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;...&lt;/span&gt;

    &lt;span class=&#34;n&#34;&gt;fd&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;open&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;/proc/self/pagemap&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;O_RDONLY&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;...&lt;/span&gt;

    &lt;span class=&#34;n&#34;&gt;virt_pfn&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;unsigned&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;long&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;virtaddr&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;/&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;page_size&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
    &lt;span class=&#34;n&#34;&gt;offset&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;sizeof&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;uint64_t&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;virt_pfn&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
    &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;lseek&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;fd&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;offset&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;SEEK_SET&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;==&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;off_t&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
        &lt;span class=&#34;p&#34;&gt;...&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;

    &lt;span class=&#34;n&#34;&gt;retval&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;read&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;fd&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;page&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;PFN_MASK_SIZE&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;...&lt;/span&gt;

    &lt;span class=&#34;p&#34;&gt;...&lt;/span&gt;
    &lt;span class=&#34;n&#34;&gt;physaddr&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;((&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;page&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;amp;&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x7fffffffffffffULL&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;page_size&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
        &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;((&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;unsigned&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;long&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;virtaddr&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;%&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;page_size&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;

    &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;physaddr&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;PFNというのはPage Frame Numberの頭文字っぽいです。&lt;/p&gt;
&lt;h1 id=&#34;cap_sys_asmin-権限で読み出す&#34;&gt;&lt;code&gt;CAP_SYS_ASMIN&lt;/code&gt; 権限で読み出す&lt;/h1&gt;
&lt;p&gt;&lt;code&gt;sudo&lt;/code&gt; しないと物理アドレスが入っているBits 0-54は0埋めされます。
&lt;a href=&#34;https://github.com/torvalds/linux/blob/v4.9/Documentation/vm/pagemap.txt#L28&#34;  target=&#34;_blank&#34; &gt;Reason: information about PFNs helps in exploiting Rowhammer vulnerability.&lt;/a&gt;とあります、
Rowhammerアタックというやつですね。
まあ危ないんで気を付けて扱いましょう。&lt;/p&gt;
</description>
    </item>
    
    
    
    <item>
      <title>20220209</title>
      <link>https://hanazonochateau.net/posts/2022/02/09/20220209/</link>
      <pubDate>Wed, 09 Feb 2022 21:48:51 +0900</pubDate>
      
      <guid>https://hanazonochateau.net/posts/2022/02/09/20220209/</guid>
      <description>&lt;p&gt;久しぶりに文章を書きたいなと思ったので、こうやって文章を書いています。&lt;/p&gt;
&lt;p&gt;今日は感傷マゾという概念について知る機会がありました。
どうも、存在しなかった理想の青春を思い浮かべ、自分の青春と比較し、自己嫌悪に陥る、それが気持ちよくて求めてしまうのが、感傷マゾということらしいです。&lt;/p&gt;
&lt;p&gt;感傷マゾに対しては、そういう性癖もあるんだなあという感じなんですが、自分にとっての存在しなかった理想の青春ってなんだろうと思いました。
例としては、&lt;/p&gt;
&lt;p&gt;「夏休みは田舎の祖母の家で一か月過ごして隣の家に住む麦わら帽子黒髪ロングの白ワンピース少女と仲良くなる」&lt;/p&gt;
&lt;p&gt;「浴衣姿の女の子と夏祭りや花火大会に行く」&lt;/p&gt;
&lt;p&gt;などがあるらしいです。
自分にはあんまりこれっていうものが思い浮かびません。
田舎の白ワンピースはちょっとフィクションっぽすぎるし、浴衣姿の女の子と夏祭りや花火大会もあんまりリアリティがありません。
存在しなかった青春の舞台は田舎かもしれないし都会かもしれないし、相手はお姉さんかもしれないし年下かもしれないし、ふわっとしています。&lt;/p&gt;
&lt;p&gt;いや、リアリティがないからこそ、リアリティのある現実として手に入れたいと希求するのが感傷マゾなのかな。&lt;/p&gt;
&lt;p&gt;自分に感傷マゾ概念がなかったのは、もう青春に対してあまり欲求がないからなのかもしれません。
そろそろ恋人とか思い出とか、作るのには興味がなくなってきたというのもあります。
高校生の時は遊んでいた同級生とかをうらやましいなあと思っていましたが、今ではうらやましさというよりかは気を使わなければいけなそうという、めんどくささの方が大きいです。&lt;/p&gt;
&lt;p&gt;それに、恋人を作っても大事にできる気もしないし、きっと疲れてしまうかなあとボーっと考えてしまいます。
興味はもしかしたらあるのかもしれませんが、疲れてしまいそうという方が大きいです。
根本的に気力がないのが悪そうです。
人生にエネルギーが足りないのかなあ。&lt;/p&gt;
&lt;p&gt;感傷マゾになるのにもエネルギーが要るということがわかりました。&lt;/p&gt;
</description>
    </item>
    
    
    
    <item>
      <title>20220201</title>
      <link>https://hanazonochateau.net/posts/2022/02/01/20220201/</link>
      <pubDate>Tue, 01 Feb 2022 22:18:57 +0900</pubDate>
      
      <guid>https://hanazonochateau.net/posts/2022/02/01/20220201/</guid>
      <description>&lt;p&gt;最近は心の調子が良いです。&lt;/p&gt;
&lt;p&gt;精神が整うと、特に書くことが無くなります。
やっぱり書き物をするときは、心に鬱屈とした何かを抱えているときのほうが勢いがあります。
心が上向きなので、書き物以外の趣味が捗ります。&lt;/p&gt;
&lt;p&gt;最近は、プログラミングとDTMを楽しくやっています。
プログラムを書いていると、プログラムのことで頭が満たされるので、余計なことが入る隙間がありません。
もちろん、プログラムを書く前に心配事が入っていると、ダメです。
DTMも同じです。
音楽を作ることはだいぶ集中力を使うので、やっぱり余計なことが入る隙間ができません。
暇ができないように、そこまで嫌なことじゃないものを頭の中に詰め込むのがよさそうです。&lt;/p&gt;
&lt;p&gt;作曲は難しいので、既存の曲をコラージュ、サンプリングして曲を作る、ブレイクビーツという手法で曲を作っています。
曲のジャンルはブレイクコア？ロリコア？ってやつです。
まだ1曲しかできていません。
これから増やしていきたいです。&lt;/p&gt;
&lt;p&gt;続くと良いな。&lt;/p&gt;
</description>
    </item>
    
    
    
    <item>
      <title>20220128</title>
      <link>https://hanazonochateau.net/posts/2022/01/28/20220128/</link>
      <pubDate>Fri, 28 Jan 2022 23:16:18 +0900</pubDate>
      
      <guid>https://hanazonochateau.net/posts/2022/01/28/20220128/</guid>
      <description>&lt;p&gt;今日は久々にプログラムを書きました。
資料を見ながら、C言語で書かれていたものをRustで実装しようと午前中は頑張っていました。
最近は趣味のプログラムを全く書いていなかったので、なんだか頭が洗われるような気分になりました。
何も締め切りとか、課題とか、そういうものに追われていないプログラムを書くことは、とても気持ちいいことだということを実感しました。&lt;/p&gt;
&lt;p&gt;昼食は外で食べて、日光を浴びてきました。
太陽に晒されたのは30分程度でしたが、心が上向きになったので良かったです。
4月から仕事が始まったら意識的に日光に当たることを心がけようと思います。&lt;/p&gt;
&lt;p&gt;夕方には指導教官の先生と面談をしました。
内容は卒論のことです。
やっぱり顔を見て話すことができると安心します。
普段は、卒論のPDFファイルを送って、それにコメントを入れて返してもらうというのが作業の流れです。
かなり的確なアドバイスがもらえるのでありがたいです。
しかし、指摘が無味乾燥なテキストとして送られてくると、しかもそれが何件もあると、刺激的な意味がないとわかっていても心が折れます。
自分は無意識のうちに、ついつい言外の意味を勝手に想像してしまう癖があるみたいです。
無意識にやってしまっているのでなかなか直す手だてが思いつきません。
どうしたらいいんでしょうね？&lt;/p&gt;
</description>
    </item>
    
    
    
    <item>
      <title>書くのが面倒</title>
      <link>https://hanazonochateau.net/posts/2022/01/27/too_lazy_to_write/</link>
      <pubDate>Thu, 27 Jan 2022 17:04:53 +0900</pubDate>
      
      <guid>https://hanazonochateau.net/posts/2022/01/27/too_lazy_to_write/</guid>
      <description>&lt;p&gt;文章を書くのが面倒になってきました。&lt;/p&gt;
&lt;p&gt;文章を書くのにはエネルギーが必要です。
でも具体的にエネルギーってなんだろうとも思います。
文章を書くエネルギーについて、少し考えてみました。&lt;/p&gt;
&lt;p&gt;まず、文章を書くのにはネタが必要です。
ネタが無くても、書くことについて書いたり&lt;sup id=&#34;fnref:1&#34;&gt;&lt;a href=&#34;#fn:1&#34; class=&#34;footnote-ref&#34; role=&#34;doc-noteref&#34;&gt;1&lt;/a&gt;&lt;/sup&gt;、何もしないを書くことも可能です。
しかし、面白いと思われる文章は何らかの出来事があって、そこに執筆者の意見だったり感想だったりを書き連ねていくことが多いと思われます。
ネタがある状態でも必ずしも記事が書けるわけではありませんが、文章を書くモチベーションは大きく上がります。
面白いもの、ことがあると、読んでくれる人に伝えたいと思うからです。
少なくとも自分はそうだと思います。
なので、普段から様々なものやことに触れて、心の備蓄をちゃんとしておかないと、良い文章は書けない気がします。&lt;/p&gt;
&lt;p&gt;次に、キーボードの前に座って、頭をこねくり回しながら文章を打ち込んでいくことが必要です。
この作業が一番大変かもしれません。
自分の脳内にあるよしなしごとを、他人に伝えなくてはならないからです。
「君の文章は、私が私の貴重な時間を割いて読んだとして、何か役に立つのかい？それとも私を感動させ、涙させ、奮い立たせる何かがあるのかい？」
と、このような読者Aさんが脳内にいて、自分の手をしょっちゅう止めさせます。
そのたびに読者Aさんには申し訳なくなりますが、でも自分には伝えたいことがあるのです、書かねばなりません。
脳内に流れる小川から考えを掬い取って、それをくっつけてちょん切って整頓します。
できるだけ見た目が良いように揃えます。
自分の心を整理して、何が一番言いたいことなのかをはっきりさせます。
その結果主題から逸れたとしても、それが自分が伝えたいことならいいと思います。&lt;/p&gt;
&lt;p&gt;ここまで終えたら文章はほぼできたようなものですが、最後にそれを公開するというのもあります。
大体の文章は苦も無く公開ができるのですが、ごく一部その踏ん切りがつかないものもあります。
自分は、とても心に響いた本や作品の感想を書く文章で、そういうものがあります。
どうしてももっとうまく書けるはず、もっと自分の感情を表現できるはずと思ってしまい、なかなか公開ができないのです。
そういうものもエイヤと公開してしまえばいいのですが、一度公開された文章にはあまり手を加えたくないという気持ちがあります。
実は今も書き溜めているけど公開ができないという文章はあります。
踏ん切りがつかずお蔵入り、ということにはしたくないので、いつかは未完成のまま放流しようと思います。&lt;/p&gt;
&lt;p&gt;ネタ探し、文字起こし、公開の3段階でエネルギーが要るという話でした。&lt;/p&gt;
&lt;!-- raw HTML omitted --&gt;
&lt;section class=&#34;footnotes&#34; role=&#34;doc-endnotes&#34;&gt;
&lt;hr&gt;
&lt;ol&gt;
&lt;li id=&#34;fn:1&#34; role=&#34;doc-endnote&#34;&gt;
&lt;p&gt;この記事のようなもの&amp;#160;&lt;a href=&#34;#fnref:1&#34; class=&#34;footnote-backref&#34; role=&#34;doc-backlink&#34;&gt;&amp;#x21a9;&amp;#xfe0e;&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;/section&gt;
</description>
    </item>
    
    
    
    <item>
      <title>20220125</title>
      <link>https://hanazonochateau.net/posts/2022/01/25/20220125/</link>
      <pubDate>Tue, 25 Jan 2022 10:01:54 +0900</pubDate>
      
      <guid>https://hanazonochateau.net/posts/2022/01/25/20220125/</guid>
      <description>&lt;p&gt;朝から酒を飲んでいる、ダメダメだ。
瞼がけいれんしている。
気持ちは落ち着いているけど、それはアルコールでボーっとしているからかもしれない。
なんだか頭がぽわぽわしていてあまり有意義なことを考えられない。
手が他人の物のように感じる。&lt;/p&gt;
&lt;p&gt;キーボードの打鍵感がない。
指先の感触が嘘みたい。
眠気がないくせに考えがまとまらない。
皮膚のほてりが嘘みたい。
部屋の現実感がない。
6畳の寒さが嘘みたい。&lt;/p&gt;
&lt;p&gt;みんな嘘。&lt;/p&gt;
&lt;p&gt;15時になって、酒が抜けた。
正気に戻ったら急に寒くなって、布団に潜った。
布団は暖かくて気持ちいい。
外界から僕を守る殻。
それから、眠った気もするし、眠らなかった気もする。&lt;/p&gt;
&lt;p&gt;実家から米が届いた。
久しぶりに炊いて、1合食べた。&lt;/p&gt;
</description>
    </item>
    
    
    
    <item>
      <title>20220124</title>
      <link>https://hanazonochateau.net/posts/2022/01/24/20220124/</link>
      <pubDate>Mon, 24 Jan 2022 21:46:36 +0900</pubDate>
      
      <guid>https://hanazonochateau.net/posts/2022/01/24/20220124/</guid>
      <description>&lt;p&gt;今日はしっかり眠れたはずなのに、駄目になってしまいました。
作業をしていたら突然不安が襲ってきて、椅子に座っていられなくなりました。
どうしようもなかったのでとりあえず意識を落としたいと思って布団に入ったのですが、心臓がバクバクしてしまって寝付けませんでした。
胸が痛くなって駄目だ駄目だと考えてたらいつの間にか意識が少しだけ飛んでて、そうしたら耐えられないほどではなくなっていました。
でもそれでも胸が痛くて、なんだかフワフワした思考しかできなくて、つらい一日でした。&lt;/p&gt;
&lt;p&gt;寒いのかわかりませんが、キーボードが上手く打てません。&lt;/p&gt;
&lt;p&gt;そういえば昨日は日記を書き忘れていました。
別に毎日続けようと思っていたわけではありませんが、書き続けていると書いていない日がぽっかり空いていると違和感があります。
でもそういう義務感で続けていると多分飽きてくるので、サボるくらいがちょうどよさそうです。&lt;/p&gt;
&lt;p&gt;読み返してあまりにもばらばらの文だなあと思いましたが、まあいいでしょう。&lt;/p&gt;
</description>
    </item>
    
    
    
    <item>
      <title>キャベツのスープ</title>
      <link>https://hanazonochateau.net/posts/2022/01/23/cabbage-soup/</link>
      <pubDate>Sun, 23 Jan 2022 06:27:33 +0900</pubDate>
      
      <guid>https://hanazonochateau.net/posts/2022/01/23/cabbage-soup/</guid>
      <description>&lt;p&gt;きょうは少し早起きで&lt;/p&gt;
&lt;p&gt;時間はたっぷりあるんだけど&lt;/p&gt;
&lt;p&gt;きのうはちょっと食べすぎちゃった&lt;/p&gt;
&lt;p&gt;だからスープにしちゃいましょう&lt;/p&gt;
&lt;p&gt;朝はキャベツのスープがいいな&lt;/p&gt;
&lt;p&gt;本に出てきておいしそうだったから&lt;/p&gt;
&lt;p&gt;キャベツを切って&lt;/p&gt;
&lt;p&gt;余っている白菜もすこしだけ&lt;/p&gt;
&lt;p&gt;お肉はないけどいいよね&lt;/p&gt;
&lt;p&gt;お鍋に水をたっぷりと&lt;/p&gt;
&lt;p&gt;葉っぱをいれて火をつけて&lt;/p&gt;
&lt;p&gt;お塩をひとふり&lt;/p&gt;
&lt;p&gt;あとはぐつぐつ煮るだけ、簡単！&lt;/p&gt;
&lt;p&gt;キャベツがクタッとしてきたら&lt;/p&gt;
&lt;p&gt;コンソメをふた欠け入れて&lt;/p&gt;
&lt;p&gt;溶けるまでひと煮立ち&lt;/p&gt;
&lt;p&gt;そうすればもう完成！&lt;/p&gt;
&lt;p&gt;少しにごったコガネ色のスープ&lt;/p&gt;
&lt;p&gt;ひとさじすくって口に入れれば&lt;/p&gt;
&lt;p&gt;日向の味があたまに広がる&lt;/p&gt;
&lt;p&gt;キャベツをすくって口に入れれば&lt;/p&gt;
&lt;p&gt;大地の味がからだに広がる&lt;/p&gt;
&lt;p&gt;キャベツをかきわけあっという間に&lt;/p&gt;
&lt;p&gt;お椀の底が見えたと思ったら&lt;/p&gt;
&lt;p&gt;でも残念、髪の毛が一本&lt;/p&gt;
&lt;p&gt;黒の一筋でもう台無し&lt;/p&gt;
&lt;p&gt;早く洗っていかなくちゃ&lt;/p&gt;
</description>
    </item>
    
    
    
    <item>
      <title>20220122</title>
      <link>https://hanazonochateau.net/posts/2022/01/22/20220122/</link>
      <pubDate>Sat, 22 Jan 2022 19:42:49 +0900</pubDate>
      
      <guid>https://hanazonochateau.net/posts/2022/01/22/20220122/</guid>
      <description>&lt;p&gt;今日は病院に行ってきました。&lt;/p&gt;
&lt;p&gt;眠れないことを言ったら薬が増えました。
毎回2分で終わる診療が5分かかったので、少し新鮮な気持ちでした。
これで眠れるようになるとうれしいです。&lt;/p&gt;
&lt;p&gt;昼にはいわゆる二郎系ラーメンを食べてきました。
普通の量を頼んだはずだったのですが、久しぶりに食べたらこんなに多かったっけ？
と思うくらいお腹いっぱいになって、もう二郎系はそろそろきつくなってきたのかなと感じました。&lt;/p&gt;
&lt;p&gt;食べるという行為は生きる力に直結する行いだと思います。
老人は食べられなくなって死んでいくと聞いたことがあります。
自分のことは体力がないと思っていましたが、やっぱりたくさん食べることができていたので、
若さゆえの生命力みたいなのはあったんだなと思いました。
これからは意識して活力を蓄えていかなくてはならないのかもしれません。
なかなか面倒なことです。&lt;/p&gt;
</description>
    </item>
    
    
    
    <item>
      <title>ギンイロノウタ</title>
      <link>https://hanazonochateau.net/posts/2022/01/22/giniro-no-uta/</link>
      <pubDate>Sat, 22 Jan 2022 04:58:04 +0900</pubDate>
      
      <guid>https://hanazonochateau.net/posts/2022/01/22/giniro-no-uta/</guid>
      <description>&lt;p&gt;&lt;em&gt;この文章は、村田沙耶香『ギンイロノウタ』の感想メモです。&lt;/em&gt;&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;SNS上で通話していたとき、通話相手の人からこの本を勧められました。
特にあらすじなども確認せずにタイトルだけを見て買いました。
2つのお話がこの本には収録されているのですが、そのうちの一つである『ひかりのあしおと』について感想を吐き出したいと思います。&lt;/p&gt;
&lt;p&gt;主人公が持つ焦燥感を文章から感じて、息苦しさを感じながら読むことができました。
誉と名付けられた主人公は、小学生のころから「光」に追いかけられます。
「光」は様々で、太陽光だったり蛍光灯だったりします。
何かに常に追いかけられるのは大変つらいことだと思います。
それが人だったり、仕事だったり、何か漠然とした不安だったりと、現実では原因は人それぞれですが、やはり、毎日ちくちく針で刺されるのは耐えられ&lt;sup id=&#34;fnref:1&#34;&gt;&lt;a href=&#34;#fn:1&#34; class=&#34;footnote-ref&#34; role=&#34;doc-noteref&#34;&gt;1&lt;/a&gt;&lt;/sup&gt;ません。
男の人と付き合うことで誉はそれから逃れようとしますが、それでも「光」から逃れることはできません。
根本を何とかしない限りはジリ貧です。
「自分の脂汗が充満する世界で、私は、いつまで、どこまで逃げればいいのか」と途方に暮れます。&lt;/p&gt;
&lt;p&gt;途中で「光」が現れた原因がわかります。
小学生の頃のいたずらがトラウマとなっていたのです。
しかし原因がわかっても、「光」は追いかけてくるのをやめません。
もはや原因はどうでもよく、追いかけてくる「光」だけが残りました。
私はこの、原因が形骸化してつらさ、焦りだけが残るという感情をしょっちゅう経験しています。
しかしこのつらさが本質なのであって、原因はこのつらさが現れるきっかけでしかないということはなんとなく理解しています。&lt;/p&gt;
&lt;p&gt;しかし、誉の前に蛍という男の人が登場します。
彼は誉を優しく包み込んで、最終的には誉を救う手伝いをします。
「光」は追いかけてくるものではなく、自分を狂気から引き止めてくれていたのだと気づき、誉は安心して眠ることができるようになります。&lt;/p&gt;
&lt;p&gt;ですが、現実では蛍が現れることはそうそうありません。
倉庫の中での特権的瞬間&lt;sup id=&#34;fnref:2&#34;&gt;&lt;a href=&#34;#fn:2&#34; class=&#34;footnote-ref&#34; role=&#34;doc-noteref&#34;&gt;2&lt;/a&gt;&lt;/sup&gt;もなく、
自分でなんとかこの焦りやつらさを、徐々に受容していくしかないことはわかっています。
そう思うと、なんだかこのお話がかなり都合よく、芝居がかったものに感じられるのは私だけでしょうか。&lt;/p&gt;
&lt;p&gt;レビューサイトで他の人の感想を見たら、共感できなかったというコメントがちらほら見かけられてかなり驚きました。
この息苦しさ、焦燥感はみんな持っているものだと思っていたから、もしかして自分は少しずれているのかなと、ぼんやり感じました。&lt;/p&gt;
&lt;p&gt;かなり共感する部分があって、好きな本です。&lt;/p&gt;
&lt;!-- raw HTML omitted --&gt;
&lt;section class=&#34;footnotes&#34; role=&#34;doc-endnotes&#34;&gt;
&lt;hr&gt;
&lt;ol&gt;
&lt;li id=&#34;fn:1&#34; role=&#34;doc-endnote&#34;&gt;
&lt;p&gt;ジャングルニエ『孤島』から引用&amp;#160;&lt;a href=&#34;#fnref:1&#34; class=&#34;footnote-backref&#34; role=&#34;doc-backlink&#34;&gt;&amp;#x21a9;&amp;#xfe0e;&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li id=&#34;fn:2&#34; role=&#34;doc-endnote&#34;&gt;
&lt;p&gt;&lt;sup id=&#34;fnref:1&#34;&gt;&lt;a href=&#34;#fn:1&#34; class=&#34;footnote-ref&#34; role=&#34;doc-noteref&#34;&gt;1&lt;/a&gt;&lt;/sup&gt;と同様&amp;#160;&lt;a href=&#34;#fnref:2&#34; class=&#34;footnote-backref&#34; role=&#34;doc-backlink&#34;&gt;&amp;#x21a9;&amp;#xfe0e;&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;/section&gt;
</description>
    </item>
    
    
    
    <item>
      <title>20220121</title>
      <link>https://hanazonochateau.net/posts/2022/01/21/20220121/</link>
      <pubDate>Fri, 21 Jan 2022 20:58:03 +0900</pubDate>
      
      <guid>https://hanazonochateau.net/posts/2022/01/21/20220121/</guid>
      <description>&lt;p&gt;なんだか今日はもう疲れてしまいました。&lt;/p&gt;
&lt;p&gt;今日は3時に目が覚めてしまったので、そこから起きて何かをしていたと思うのですが、覚えていません。
8時になってお腹が空いたので朝ご飯を食べて、昼になって本屋に行きました。
昨日SNSで通話した相手がおすすめの本を教えてくれたので、それを買うためです。
10分くらいで求めていた本は見つかったのですが、他にも良さげな本はないかと探し回っていたので、結局1時間くらい居座ってしまいました。
文庫を3冊買って帰りました。
しばらく寝たり起きたり、まどろんでいたら18時になっていました。
前から注目していたゲームが配信開始していたので、購入して少しだけプレイしました。
ところが途中までやっていたらなんだか進行が止まってしまい、どうしようもなくなってしまったので、ゲームをやめました。
暇になったので、午前中に買ってきた本のうちの1冊を、半分だけ読みました。&lt;/p&gt;
&lt;p&gt;全体的にぼーっとしてしまってすっかり駄目です。
多分寝不足がいけないんでしょう。
明日はクリニックなので、先生に寝不足のことについて話したいと思います。&lt;/p&gt;
</description>
    </item>
    
    
    
    <item>
      <title>20220120</title>
      <link>https://hanazonochateau.net/posts/2022/01/20/20220120/</link>
      <pubDate>Thu, 20 Jan 2022 20:47:49 +0900</pubDate>
      
      <guid>https://hanazonochateau.net/posts/2022/01/20/20220120/</guid>
      <description>&lt;p&gt;今日はサイトの文章をいっぱい更新した日でした。
前から書き溜めていたものもあったのですが、それでも今日は沢山書いた日だったと思います。
直近でやらなくてはいけないことがあり、そっちの進捗が悪いのでついついサイトの更新が捗ってしまいます。&lt;/p&gt;
&lt;p&gt;自分の脳内をさらけ出すって、意外と気持ち良いことだと最近気づきました。
世の中のネット日記を続けている人たちの気持ちがわかりました。
きっと数年後に見返したら恥ずかしさで悶絶するようなことを書いているんでしょうけど。
リストカットと同じことなのかもしれません。
血を流す代わりに自分の思ったことをインターネットに垂れ流す。
気分がスーッとして、少しだけ落ち着きます。
この行為を自分はデジタルリストカットと名づけました。
脳ミソを切って、思考をインターネットに流す。
誰かがインターネットアーカイブに保存していたら、一生残る傷になる。
頭を切っているからリストカットとは違うのか？
こっちのほうが重症かもしれませんね。&lt;/p&gt;
&lt;p&gt;毎日気分がすぐれなくて、薬を飲み忘れているのではないかと常に疑ってしまいます。
1日1錠の薬を、今日は間違えて2錠飲んでしまいました。
だから頭の回転がここ最近で一番速いのかもしれません。
でも速度を制御できるわけではなくて、強制的に走らされている感じ。
今日の文章はもしかしたらめちゃくちゃかもしれません、申し訳ない。&lt;/p&gt;
&lt;p&gt;昼寝もできるようになりました。
やっと眠れるようになってきた感じがします。
このまま持ち直せるとうれしいです。&lt;/p&gt;
</description>
    </item>
    
    
    
    <item>
      <title>白い薔薇の淵まで</title>
      <link>https://hanazonochateau.net/posts/2022/01/20/shiroi-bara-no-fuchi-made/</link>
      <pubDate>Thu, 20 Jan 2022 14:03:26 +0900</pubDate>
      
      <guid>https://hanazonochateau.net/posts/2022/01/20/shiroi-bara-no-fuchi-made/</guid>
      <description>&lt;p&gt;自分は燃え上がる恋愛というものをしたことがなく、というかそもそも恋愛をしたことがない。
『白い薔薇の淵まで』はまさに身を焦がす恋愛の話だが、本屋で見かけたときは恋愛の話なんて刺さらないだろうと見逃した。
後で「究極の恋愛小説」と太鼓判が押されているのを耳にして、そこまで言うならと注文した。&lt;/p&gt;
&lt;p&gt;そうして読んでみると確かに「究極」というふれこみは間違いではなかった。
人格が破綻している小説家の塁と、それにひかれたクーチというOLの、どう考えても破滅にしか向かわない恋愛は、胸が苦しくなるものだった。
互いに嫉妬しあい、求めあうその姿は、傍から見れば醜いかもしれない。
しかし本人たちにとっては、それはとても美しい記憶となって、互いを縛り上げる。
多分恋愛の程度にも境界があると思うのだが、二人の恋愛は互いを死に至らしめるギリギリの淵を歩いていたと感じる。
終盤には、塁は淵の向こう側へと行ってしまった。
そして最後のページで、クーチも白い薔薇の淵に向かう。&lt;/p&gt;
&lt;p&gt;読み終わって、この二人にはうらやましさを感じた。
こんなに互いを求めあえるような人物には、おそらく一生かけても出会うことができないと思う。
恋焦がれる相手を見つけたくなる本だった。&lt;/p&gt;
</description>
    </item>
    
    
    
    <item>
      <title>キャラクターメーカー</title>
      <link>https://hanazonochateau.net/posts/2022/01/20/character-maker/</link>
      <pubDate>Thu, 20 Jan 2022 11:44:41 +0900</pubDate>
      
      <guid>https://hanazonochateau.net/posts/2022/01/20/character-maker/</guid>
      <description>&lt;p&gt;&lt;em&gt;この文章は、『キャラクターメーカー 6つの理論とワークショップで学ぶ「つくり方」』の読書メモです。&lt;/em&gt;
&lt;em&gt;メモなのでかなり雑に書いています。&lt;/em&gt;&lt;/p&gt;
&lt;hr&gt;
&lt;h1 id=&#34;第1講-アバター式キャラクター入門&#34;&gt;第1講 アバター式キャラクター入門&lt;/h1&gt;
&lt;p&gt;「アバター」とは、読者が感情移入する対象であり、主人公であるとは限らない。
ハリウッドでは主人公の周辺にアバターを配置することが多い。
モノローグによって自問自答するタイプの主人公は、主人公とアバターの両方の役割を持っていることになる。&lt;/p&gt;
&lt;p&gt;アバターは何らかの構成要素に分解でき、またその構成要素は単独では意味をなさない。
構成要素の組み合わせによって、キャラクターが構成される。
キャラクターは属性で分類されるのではなく、属性を組み合わせることによって出来上がる。&lt;/p&gt;
&lt;h4 id=&#34;ワークショップ1&#34;&gt;ワークショップ1&lt;/h4&gt;
&lt;p&gt;ダイスを振ったところ、7、2、7が順番に出て、「尻がバッタ」のキャラクターを考えることになった。\
バッタから連想すると、飢饉のイメージが浮かんできた。
穀物を食いつくし、後には何も残らない、恐ろしい印象がある。\
尻にバッタの胴体がくっついているキャラクターを想像してみる。
デビルマンみたいな世界観になるのかしら？
そうすると、バッタは大群で押し寄せてくる印象があるので、兵士として描くのがよさそう。
スターウォーズのドロイド兵のような感じになるのか。\
しかしそうなるとモブキャラとしてしか使えないので、別の案を考えてみる。
身体が昆虫になるというと、カフカの『変身』が思い浮かぶ。
グレゴール・ザムザは毒虫だったが、今回はバッタなので少し毛色が違う。
全身が虫になるのではなく、尻だけなので、『変身』のような物語ではなさそう。\
バッタと言えば『仮面ライダー』になるのか。
やはり変身ものなら相性がよさそうだ。&lt;/p&gt;
&lt;h5 id=&#34;出来上がったキャラクター&#34;&gt;出来上がったキャラクター&lt;/h5&gt;
&lt;p&gt;普段は心優しい青年だが、ある時悪魔と融合してバッタ人間になる。
怒りを覚えると尻がバッタに変身し、気性が荒くなる（これはサバクトビバッタの性質について調べた結果だ）。
敵味方関係なく皆殺しにしてしまうため、変身した姿は市民からは恐ろしがられている。
自身の攻撃性に悩み、暴走を何とか抑えようとするが、恋人を殺めてしまった過去があり、それからは感情を殺し、誰にも期待せずに生きている。&lt;/p&gt;
&lt;p&gt;……なんか少しデビルマンっぽくなってしまった。&lt;/p&gt;
&lt;h1 id=&#34;第2講-トトロもエヴァンゲリオンもライナスの毛布である&#34;&gt;第2講 トトロもエヴァンゲリオンも「ライナスの毛布」である&lt;/h1&gt;
&lt;p&gt;何らかの限定された空間、時間の中でのみ発生する「私」がキャラクターの印象を決定する。
「ある女の手紙」では、手紙の中の、さらに言文一致の文体においてのみ、妹たちの本性が垣間見える。
キャラクターと書き手は当然つながっているが、キャラクターを作る上では直接的に「私」をカミングアウトしない技術が必要。&lt;/p&gt;
&lt;p&gt;本当の血筋がべつにあるといった「ファミリーロマンス」は、キャラクターとしての「私」を作る基礎となる。
似たものに「移行対象」があり、母/乳房の代わりとしてあらわれるもの、と言われている。
「スヌーピー」に出てくる「ライナスの毛布」としても例えられる。
トトロは両親から急に分離した際のライナスの毛布としてとらえることができる。
移行対象のキャラクターはただそこに「居る/在る」だけの存在として描かれる。&lt;/p&gt;
&lt;p&gt;移行対象には二つタイプがある。
一つ目はキャラクターとして投影しやすい「トトロ型」、二つ目はキャラクターというよりかは純然としたモノとして描かれる「ライナスの毛布型」に分類できる。
ライナスの毛布型の物語として『姥皮』が挙げられる。
姥皮というアイテムによってキャラクターは仮の姿に変身するが、最後はそれを脱ぎ捨てて真の自分に生まれ変わる。
キャラクターの成長を促し、かつそのキャラクターを守る殻としての役割を果たす。&lt;/p&gt;
&lt;h4 id=&#34;ワークショップ2&#34;&gt;ワークショップ2&lt;/h4&gt;
&lt;p&gt;以下のような人物を考えた。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;高校3年生の少女&lt;/li&gt;
&lt;li&gt;最近引っ越してきたばかりで学校では孤立しており、かつ知能は高いため周りとなじめずにいる(未成熟の要素)&lt;/li&gt;
&lt;li&gt;親は再婚しており、母親とは血がつながっていない(悩み、ファミリーロマンス)&lt;/li&gt;
&lt;li&gt;ほんとうの母親から幼少期に買ってもらったハーモニカを大切に吹いている(移行対象物)&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id=&#34;第3講-手塚キャラクターは何故テーマを属性としているか&#34;&gt;第3講 手塚キャラクターは何故テーマを「属性」としているか&lt;/h1&gt;
&lt;p&gt;物語はキャラクターに対して成長することを求めるが、手塚治虫のキャラクター、例えばアトムは「成長できない身体」を与えられる。
しかし、アトムは生みの親から「成長する身体」を求められ、失望されたアトムは捨てられることになる。
「成長する身体」と「成長できない身体」の矛盾を手塚はアトムというキャラクターに与えている。
キャラクターとしての本質を属性として付与する手法を、大塚は「アトムの命題」と呼んでいる。&lt;/p&gt;
&lt;h4 id=&#34;ワークショップ3&#34;&gt;ワークショップ3&lt;/h4&gt;
&lt;p&gt;属性1と属性2の具体化として以下のようなキャラクターを考えた。&lt;/p&gt;
&lt;p&gt;近未来、事故に遭った少女は気づいたらサイボーグとなっていた。
少女は、巨大な機械の左手を武器に、自らをサイボーグの身体にした張本人を探し求める。
普通に暮らしたい少女に対して、その左手はあまりに暴力的な見た目をしている。
また、その左手を行使してときには人を殺めなければならず、そのことに苦悩する。
ここに、身体の矛盾が発生する。&lt;/p&gt;
&lt;h1 id=&#34;第4講-雨宮一彦の左目にバーコードがあるのは何故か&#34;&gt;第4講 雨宮一彦の左目にバーコードがあるのは何故か&lt;/h1&gt;
&lt;p&gt;キャラクターは何かの「欠如」か「過剰」があると物語を始めやすい。
この「欠如」か「過剰」を「均衡」に持っていくのが定番。&lt;/p&gt;
&lt;p&gt;また物語では「均衡」と「不均衡」が対立することが必要である。
しばしば「正義」と「悪」のような対立として描かれる。&lt;/p&gt;
&lt;p&gt;「欠如」や「過剰」はある意味で「聖痕」「標」である。
それが疎まれる原因となることもあれば、「私」を証明する目印にもなる。&lt;/p&gt;
&lt;h4 id=&#34;ワークショップ4&#34;&gt;ワークショップ4&lt;/h4&gt;
&lt;p&gt;ダイスをふったところ、以下の特徴が出た。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;男&lt;/li&gt;
&lt;li&gt;首に聖痕&lt;/li&gt;
&lt;li&gt;聖痕は外から見える&lt;/li&gt;
&lt;li&gt;聖痕は異物の付着によるもの&lt;/li&gt;
&lt;li&gt;呪いによる&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;上記をふまえて以下のキャラクターを考えた。&lt;/p&gt;
&lt;p&gt;主人公は首に小さな札が貼られている。
首の札は両親が所属する新興宗教団体が、幼少期の主人公に貼ったものである。
普段は札をカモフラージュするために奇抜な服装をしている。
本人は札のことを快く思っていないが、以前札を剝がした際に友人が亡くなるという事件が起こっており、札をはがすことに対して恐怖心も持ち合わせている。&lt;/p&gt;
&lt;h1 id=&#34;第5講-自分からは何もしない主人公を冒険に旅立たせるためのいくつかの方法&#34;&gt;第5講 自分からは何もしない主人公を冒険に旅立たせるためのいくつかの方法&lt;/h1&gt;
&lt;p&gt;プロップによると、主人公は基本的には受け身の存在である。
しかし物語では、主人公は「受け身」であるが「自分探し」をしなければならない。
主人公は「探索者型」と「被害者型」に分けられる。
探索者型は、主人公の所有物などが奪われることや、探し物を頼まれるなどがあり、それを取り戻す、または探すために行動する。
被害者型は、主人公自体が追い出されたり、追われる立場に追いやられる。
どちらにしてもきっかけは受動的である。&lt;/p&gt;
&lt;p&gt;「出立」「イニシエーション」「帰還」から物語は成り立っており、「出立」は以下の5つから成り立っている。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;冒険の召命&lt;/li&gt;
&lt;li&gt;召命の辞退&lt;/li&gt;
&lt;li&gt;超自然的なるものの援助&lt;/li&gt;
&lt;li&gt;最初の境界の越境&lt;/li&gt;
&lt;li&gt;鯨の胎内&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;「鯨の胎内」は、象徴的な死をイメージする。
「召命の辞退」は、主人公が今居る環境から抜け出す不安と、このまま「今」でいたいという気持ちの表れである。&lt;/p&gt;
&lt;h4 id=&#34;ワークショップ5&#34;&gt;ワークショップ5&lt;/h4&gt;
&lt;p&gt;// TODO&lt;/p&gt;
&lt;h1 id=&#34;第6講-影との戦い&#34;&gt;第6講 影との戦い&lt;/h1&gt;
&lt;p&gt;「敵対者」は主人公と反対の方向に自己実現をした「影」であることがある。
影はしばしば主人公によって救済され、主人公の自己実現になる。&lt;/p&gt;
&lt;h4 id=&#34;ワークショップ6&#34;&gt;ワークショップ6&lt;/h4&gt;
&lt;p&gt;// TODO&lt;/p&gt;
&lt;h1 id=&#34;本の感想&#34;&gt;本の感想&lt;/h1&gt;
&lt;p&gt;物語論から使えるものをピックアップしてきて提示してくれているありがたい本だと思った。
第3講で取り扱った身体の矛盾という部分がまだよく理解できていない。
「身体」とは言ってるけど、別に身体のことでなくてもいいのではないのか。
なんらかの矛盾がキャラクター内に存在すれば、それは第6講の「影」ともつながってくる話だと感じた。
物語を作る上で難しそうなのは影との和解であり、ここでオリジナリティとか面白さとかが生まれるのかなと思った。
ただ、この本に書かれている全部を守って物語を作る必要はないのかなと感じる。
必要になったり、何かしっくりこないと感じたり、一度キャラクターを俯瞰してみたりする際に読み直すといいのかもしれない。&lt;/p&gt;
&lt;p&gt;TODOになっているワークショップはいつかやる。&lt;/p&gt;
</description>
    </item>
    
    
    
    <item>
      <title>世間知らず</title>
      <link>https://hanazonochateau.net/posts/2022/01/20/naive/</link>
      <pubDate>Thu, 20 Jan 2022 07:14:52 +0900</pubDate>
      
      <guid>https://hanazonochateau.net/posts/2022/01/20/naive/</guid>
      <description>&lt;p&gt;ずっと部屋にこもっていると、世間で起きている出来事に疎くなります。
疎くなるというか、かなりどうでもよくなる感じです。
Twitterもトレンド機能を実質オフにしている(トレンドの国名をウガンダにしている)ので、自発的に調べない限りは世間の動きが入ってきません。
しかし社会で起きていることは大抵つらいことなので、自分みたいに自分のことで精いっぱいな人はこのほうが心が落ち着きます。
例えば、芸人の宮迫という人が詐欺みたいなのに引っかかって焼肉屋を経営していることを、つい最近知りました。
宮迫という芸人は昔は下の名前まで憶えていたのですが、今は忘れてしまいました。
確か相方がいたと思うのですが、どんな人だったっけ。
あとは、トンガの火山が噴火したことも相当遅れて、津波警報で初めて知りました。&lt;/p&gt;
&lt;p&gt;世間の出来事に対して精力的にコメントを飛ばしている人を見ると、そのスタミナに驚きます。
自分はとてもそんな気力はないので、ある意味でうらやましいです。
それに、短文で自分の意見を表明するのって、かなり難しいと思います。
自分のどうでもいいつぶやきでも、文の書き方によっては誤解されることがあります。
また、対立する意見を持っている人が、自分の意見を悪いように曲解して(ギリギリ言い逃れができる範囲で)翻訳し、それを拡散される恐れもあると思います。
そう思うと恐ろしくてコメントを飛ばすことなんかは出来なくなります。&lt;/p&gt;
&lt;p&gt;でも一番大きいのは、ある事件に対して自分の考えを構築することが面倒なことです。
「君はこの出来事に対してどう思うんだい？」
自分には教養も頭の良さもないし、自分の頭で考えるといった大変立派なことは習慣として構築してこなかったので、こういう目線を向けられると大変つらいです。
自分の意志を持って行動することなんて、ご飯のことくらいしかありません。
あとはほとんどが他人に流されたりとか、やらなくてはいけない義務から仕方なくとか、といった感じです。
というか自分とは遠い場所に対して、あまり興味が湧かないのがあるんだと思います。
自発的に旅行に行ったことはあまりないし、やる気も出ません。
海外旅行なんてもってのほかです。
インターネットは確かに便利ですが、自分と遠い場所のことが毎日流れてきます。
物理的にも、精神的にもです。
興味がないことを見せられるのは心が削られていきます。
インターネットと自分は、実は相性があまりよくないのかもしれません。&lt;/p&gt;
&lt;p&gt;でも自分の考えは持たないとな、とも思っています。
何事も自分の指針を持たないと、芸人の宮迫さんみたいにどこかで損したり、騙されたりすることもあります。
世の中には色々なサービスがありますが、あれはある意味お金を払って考えることを押し付けているのだと思います。
しかし、生きていると考えることがたくさんあります。
その全部を自分で考えて判断しているととても時間が足りないので、様々なサービスにお金で思考を委託することはなにもおかしなことではありませんし、悪いことでもないと思います。
しかし、自分はお金を持っていないので、自分で考える必要があります。
でも自分で物事を考えるのは、とにかく面倒で、気力が必要です。&lt;/p&gt;
&lt;p&gt;人生において、うまく生きるためには結局は気力が必要なんだと思います。
とにかく動いたり、考えたりすることが重要で、そのためには気力が要ります。
無気力人間には生きるのは難しいのかもしれません。&lt;/p&gt;
</description>
    </item>
    
    
    
    <item>
      <title>20220119</title>
      <link>https://hanazonochateau.net/posts/2022/01/19/20220119/</link>
      <pubDate>Wed, 19 Jan 2022 22:21:37 +0900</pubDate>
      
      <guid>https://hanazonochateau.net/posts/2022/01/19/20220119/</guid>
      <description>&lt;p&gt;寝不足が限界に達したのか今日は一日寝続けてしまい、そのせいで予定もすっぽかしてしまいました。
大事な予定なのに、忘れてしまったことに対してあまり焦りがなくて、なんだかこんな感じで社会人になったらちゃんと働けるのかなとぼんやりと思いました。
多分たまに怒られながらなんとなくやっていくんでしょうが。&lt;/p&gt;
&lt;p&gt;今日は大きな津波が来て人類が滅びる夢を見ました。
なんとか必死に逃げようとするのですが、波が大きすぎてみんな飲み込まれていきます。
自分は高い場所に立っている廃墟ビルに逃げ込みます。
朽ちた階段を上っていったら、屋上に出る手前の踊り場でタバコとライターを見つけました。
自分はタバコは吸わないので、後から階段を上ってきた人にあげました。
その人は人類最後のタバコを美味しそうに吸って、そして屋上に出る扉を開けました。
自分も屋上に出たら、空を覆うほどの津波が見えました。&lt;/p&gt;
&lt;p&gt;そんな夢です。&lt;/p&gt;
</description>
    </item>
    
    
    
    <item>
      <title>抑鬱気分</title>
      <link>https://hanazonochateau.net/posts/2022/01/19/depression/</link>
      <pubDate>Wed, 19 Jan 2022 08:58:17 +0900</pubDate>
      
      <guid>https://hanazonochateau.net/posts/2022/01/19/depression/</guid>
      <description>&lt;p&gt;気分が落ち込んでどうしようもないので、とにかく文章にして吐き出さなければと一心不乱にキーボードを叩いている。
これは薬を飲み忘れたからだということはわかっているので、ついさっきシートから錠剤を取り出して、水を用意するのもつらかったので噛んで飲んだ。
ごくわずかな脳内物質の血中濃度の変動が私を苦しませる。&lt;/p&gt;
&lt;p&gt;もうこの抑鬱感は高校生の時からずっと心の中にあって、気力や希望を根こそぎ奪い取っていく。
胸の奥が苦しくなり、とにかく助けてくれと言いたくなる。
苦しいという感情が頭の中を反響し、それがどんどん大きくなっていく。
もはや原因なんてなくて、苦しいことが苦しい。
苦痛の再帰関数が心のスタックを無限に食いつぶしている。&lt;/p&gt;
&lt;p&gt;一生薬漬けかと思うともうどうしようもなくなる。
この巨大な抑鬱を薬で誤魔化す人生が続くと思うと軽く絶望する。
7年間この苦しみと付き合ってきたけど、そろそろ疲れてきた。
7年は苦しむには長すぎる。&lt;/p&gt;
&lt;p&gt;できることならずっと寝ていたい。
常に眠気の中で、曖昧に意識を落としたい。
そうすれば苦しくないから。
夢も見たくない。
悪夢は苦しいから。&lt;/p&gt;
</description>
    </item>
    
    
    
    <item>
      <title>20220118</title>
      <link>https://hanazonochateau.net/posts/2022/01/18/20220118/</link>
      <pubDate>Tue, 18 Jan 2022 21:41:19 +0900</pubDate>
      
      <guid>https://hanazonochateau.net/posts/2022/01/18/20220118/</guid>
      <description>&lt;p&gt;なかなか眠れない日々が続いていますが、外に出るようにしたら気分は上がりました。&lt;/p&gt;
&lt;p&gt;今日は髪の毛を切りに行きました。
自分が行くのは所謂「床屋」と呼ばれる類の店です。
床屋の何がいいって、シャンプーして顔まで剃ってくれるところだと思います。
やっぱり髪の毛を切るだけだとなんとなくチクチクするし、それで一日を過ごすのは少しきついです。
また自分はめんどくさがり屋なので、ひげを剃ってもらえるのはだいぶ楽です。
あごひげなどは、いつもついつい放置してしまいます。
そこまでおしゃれに気をつかうわけでもないし、値段も安いので気に入っています。&lt;/p&gt;
&lt;p&gt;ただ床屋ってだいたい店主さんの年齢が高いので、5年後はまだ残っているだろうかと心配になります。
新しい床屋を探すのって難しいので、なるべく生き残って欲しいです。
社会人になって自由に使えるお金が増えたら、今の行きつけの床屋さんに行く頻度をもう少し増やしたいと思います。&lt;/p&gt;
&lt;p&gt;今日はさっぱりと布団に入ることができそうです。&lt;/p&gt;
</description>
    </item>
    
    
    
    <item>
      <title>20220117</title>
      <link>https://hanazonochateau.net/posts/2022/01/17/20220117/</link>
      <pubDate>Mon, 17 Jan 2022 21:15:24 +0900</pubDate>
      
      <guid>https://hanazonochateau.net/posts/2022/01/17/20220117/</guid>
      <description>&lt;p&gt;昼寝をしたら、大変寝覚めが悪い夢を見ました。&lt;/p&gt;
&lt;p&gt;人をいじめてたら自殺してしまい、その後十年間遺族に謝りに行くといった内容です。
自分には人をいじめるような度胸はないはずなのですが、夢の中の自分は悪い方向に思い切りが良かったです。
罪悪感といったものも夢の中では消えてしまっていて、いじめている相手が自殺してしまった時も、やっちまったなといった感想しか出てこなかったのには驚きました。
遺族に謝罪するときも反省の気持ちは湧いてこず、なんでこうなってしまったんだといった感じでした。&lt;/p&gt;
&lt;p&gt;自分の中に加害性は持っていることは理解しているのですが、無意識下にこんな大きなものが眠っているとは思いませんでした。
もちろん現実ではこんなことをするはずがないのですが、もしかしたらこのような残酷な人間になっていた可能性があると思うと、気分が悪くなります。&lt;/p&gt;
&lt;p&gt;ちょっとびっくりして気持ちがまとまっていません。&lt;/p&gt;
</description>
    </item>
    
    
    
    <item>
      <title>居酒屋</title>
      <link>https://hanazonochateau.net/posts/2022/01/17/pub/</link>
      <pubDate>Mon, 17 Jan 2022 06:40:06 +0900</pubDate>
      
      <guid>https://hanazonochateau.net/posts/2022/01/17/pub/</guid>
      <description>&lt;p&gt;店内は酔っ払いでごった返していて、店員があっちにこっちにせわしなく動き回っている。
ほとんどの客が複数人で来店していて、中には8人以上の団体客もいるが、自分はおひとり様だ。
周りを見渡すとどの客も顔が赤らみ、友人や同僚と思しき人物と楽しく会話をしている。&lt;/p&gt;
&lt;p&gt;少し離れた場所に陣取っている大学生の集団から、乾杯の音頭が上がった。
サークルのコンパかしら？
ひときわ体の大きい、幹部風の男が生ビールのジョッキをぐいと喉に流し込み、それを見た隣の女がケラケラと笑っている。
ジョッキが空になると、拍手が挙がる。
皆楽しそうにしている。&lt;/p&gt;
&lt;p&gt;自分はああいう大人数で盛り上がる雰囲気には慣れたことがない。
みんなで乾杯をするところまではいいが、少し時間が経っていくつかの「会話島」がなんとなく形成され始めると、そろそろついていけなくなる。
島ができるとだんだん会話がその島内で閉じるようになり、島の一員になり損ねるともう後からは割って入れなくなる。
会話を提供するとか、相手の言葉に対して何かうまいことでも言うとかできればいいのだけれど、面白い小噺ができるわけでもなく、ウィットに富んだ返答ができるわけでもなく、結局ただあいまいに相づちを打つだけになってしまう。&lt;/p&gt;
&lt;p&gt;そもそも自分に魅力がないのだ。
なんとなくぼんやりとしていて、はっきりしないとよく言われる。
思い返してみると、幼少期からなんとなくで物事をやり過ごしてきた気がする。
面倒なことは大抵あいまいに返答して、どっちともとれるように逃げ道を作っていたように思う。
答えをぼやかして生きてきたので、なんだか立ち位置もぼやけていて、自分でも輪郭がはっきりしない。
だから色々なことが他人事のように感じてしまうのかしら？&lt;/p&gt;
&lt;p&gt;集団の端の方で苦笑いしている男がいるのに気が付いた。
その男が参加している会話の主は大声で武勇伝を披露しているようで、すごーい！とかどうやったんですか？とかそういった類の合いの手が聞こえる。
端の男は笑いながら相づちを打ってはいるが、なんとなくリズムに乗れていないようだ。
気まずそうに手に持っているグラスに口をつけたり、つまみに手を伸ばしてみたりしている。
それを見て、きっと自分みたいな人間なんだろうと、なんとなくうれしくなった。&lt;/p&gt;
&lt;p&gt;なんで自分は居酒屋まで来てひとり黙々と酒を飲んでいるのだろう？
友人と一緒に酒を飲む気力もないが、家で一人飲むのも気が狂いそうだったので、せめて騒がしい中でと居酒屋に来たんだった。
そういえばここ数ヶ月、友人と会っていない気がする。
最後に会ったのはいつかしらん？
人付き合いが根本的に面倒で、なあなあでやってきたおかげで友人と呼べる人物は自分には少ない。
数少ない友人とも最近は面倒で連絡を取っていない。&lt;/p&gt;
&lt;p&gt;ああ一体、なんでこんなに面倒くさがりなんだろう？
きっと逃げ癖がついていて、そして大して痛い目にあってこなかったから、いい気になって面倒なことをそのままにしてしまうんだろう。
小さな失敗はいくつもしてきたけど、そのたびにまあ仕方ないよねと諦めてしまい、悔しがることをしなかった。
人生に対して熱意が足りないのかしら？
もっと真剣に物事に対して取り組んだ方がいいのかもしれない。&lt;/p&gt;
&lt;p&gt;多分当事者意識が足りないのだ。
でも正直いろんなことがどうでもいいと思ってしまう。
もっと世界に目を向けなくてはいけない、そのためには世界に対して愛着を持たないといけない気がする。
いろんなどうでもいいことに愛を持つことが重要な気がする。
わかったぞ、気づいてしまった。
キリスト教なんて馬鹿馬鹿しいと思っていたけど、博愛精神というのは自分が世界に対して当事者意識を持つために必要なのかもしれない。
そう考えると宗教も捨てたもんじゃないぞ。
家に帰ったら、前に気を違えて買った聖書を読んでみよう。&lt;/p&gt;
&lt;p&gt;ふとまたさっきの集団を見たら、端の男が隣の女と楽しそうに会話をしていた。
自分みたいなぼんやりとした人間だと勝手に思っていたが、彼は顔がはっきりと整っていることに今気づいた。
あっ、こいつめ。
おれと同類じゃなかったのか。&lt;/p&gt;
&lt;p&gt;なんだか悔しくなって、レモンサワーを追加で注文して一気に飲み干した。
腹の虫が収まらないのでもう一杯飲んで、こんなところにいられるかと会計を済ませて店を出た。
駅前で募金の呼びかけに捕まりそうになったが無視して通り過ぎ、家に帰ってそのまま寝た。&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;&lt;em&gt;自意識過剰な男の創作文章を書いてみました。&lt;/em&gt;&lt;/p&gt;
</description>
    </item>
    
    
    
    <item>
      <title>20220116</title>
      <link>https://hanazonochateau.net/posts/2022/01/16/20220116/</link>
      <pubDate>Sun, 16 Jan 2022 19:35:29 +0900</pubDate>
      
      <guid>https://hanazonochateau.net/posts/2022/01/16/20220116/</guid>
      <description>&lt;p&gt;今日は友人の車に乗せてもらって、夕飯を食べに行きました。&lt;/p&gt;
&lt;p&gt;もうすっかり日が暮れていて、飲食店に行く途中、ちょっと繁華街から脇にそれると、すぐに周りは真っ暗になりました。
車内は友人たちの話し声とエンジンの音で満たされており、他の音はよく聞こえませんでした。
窓ガラスは僕たちの吐く息で曇っていて、外にポツンポツンとある街灯が、ぼやけて丸く光って見えました。
なんだか宮沢賢治の小説に出てきそうなぼんやりとした幻想的な光だな、なんて思いながら友人たちと会話をしていました。
そのせいか、夕飯を済ませて自宅に戻ってから、ぼんやりと以前観たアニメ映画の銀河鉄道の夜を思い出しました。&lt;/p&gt;
&lt;p&gt;アニメ映画の銀河鉄道の夜を初めて観たのは、たしか小学生の頃だったと思います。
そのときは内容に関してはあまり記憶に残りませんでしたが、登場人物が軒並み動物を擬人化したデザインをしていて、それが印象に残っていました。
銀河鉄道の夜というものに触れたのがこのアニメ映画が初めてだったので、中学生になって小説を読んだ時も、脳内では猫人間が動いていました。&lt;/p&gt;
&lt;p&gt;高校生になって昔の名作アニメも観ようということで、そういえば、と思い出してレンタルしてきたのが二回目の銀河鉄道の夜でした。
再視聴したら、実は音楽や音響がとてもよかったという点に大変驚きました。
あまりメロディアスではないけど奥行きのある音楽や、どこか寂しげで優しい雰囲気を漂わせる効果音が、背景の夜空と融合していました。
登場人物の言葉が途切れたときの無音の間も、この映画の音響だと感じるほどにうまく設計されていました。
これはすごい名作を引き当てたぞと、慌てて同級生に教えました。
同級生はみんな疑問符を顔に浮かべてました。&lt;/p&gt;
&lt;p&gt;内容のこととかキャラクターデザインのこととか、もっと色々書きたいことがあるはずなんですが、なんだかよく思い出せないのでこの辺にしておきます。
静かな気持ちになりたいときに観るといいかもしれません。&lt;/p&gt;
</description>
    </item>
    
    
    
    <item>
      <title>不眠</title>
      <link>https://hanazonochateau.net/posts/2022/01/16/insomnia/</link>
      <pubDate>Sun, 16 Jan 2022 06:04:21 +0900</pubDate>
      
      <guid>https://hanazonochateau.net/posts/2022/01/16/insomnia/</guid>
      <description>&lt;p&gt;ここ一週間くらい、不眠が続いています。&lt;/p&gt;
&lt;p&gt;眠れないと思考がぐるぐるとループバックして、答えのない堂々巡りになります。
「なんで」が頭の中を反響してどうしようもありません。
嫌な考えに考えが支配されるので、強い酒を飲んで思考を鈍らせたくなります。&lt;/p&gt;
&lt;p&gt;中学生くらいから眠れないことがたまにあって、日付が変わってからもなかなか寝付けず、インターネットをぼんやりと見ていました。
まあこの時期はやる夫SS&lt;sup id=&#34;fnref:1&#34;&gt;&lt;a href=&#34;#fn:1&#34; class=&#34;footnote-ref&#34; role=&#34;doc-noteref&#34;&gt;1&lt;/a&gt;&lt;/sup&gt;にハマっていたのでそのせいであったのかもしれません。&lt;/p&gt;
&lt;p&gt;不眠で睡眠薬を出してもらったのは高校3年生が初めてでした。
受験が近づいてプレッシャーに負けてしまった僕は鬱病になってしまい、すっかり眠れなくなってしまったので、精神科医からベルソムラ&lt;sup id=&#34;fnref:2&#34;&gt;&lt;a href=&#34;#fn:2&#34; class=&#34;footnote-ref&#34; role=&#34;doc-noteref&#34;&gt;2&lt;/a&gt;&lt;/sup&gt;を処方してもらいました。&lt;/p&gt;
&lt;p&gt;ベルソムラは副作用として悪夢を見ることで有名で、僕もご多分に漏れず寝ざめの悪い夢をたくさん見ました。
特によく見たのは父親と喧嘩する夢でした。
夢の中では僕はやたらカッカと口論をしていました。
とにかく無性に怒りの感情が沸き上がって、抑えることができませんでした。
夢の中で父親を蹴ろうとして、現実でもベッドの近くにあった家具を蹴ってしまったこともありました&lt;sup id=&#34;fnref:3&#34;&gt;&lt;a href=&#34;#fn:3&#34; class=&#34;footnote-ref&#34; role=&#34;doc-noteref&#34;&gt;3&lt;/a&gt;&lt;/sup&gt;。
また、寝付いても3時間くらいで覚醒してしまうことが多く、かといって起き上がって生産的な活動をするのも難しいので、布団の中で苦痛な時間を過ごしていました。&lt;/p&gt;
&lt;p&gt;ベルソムラは大学生になってからは処方されなくなりました。
普通に眠れるようになったからです。
残った薬が大量に余ってましたが、また眠れなくなった時のためにと、一応保管はしていました。
とは言えその後も不眠が顔を出すことは余りなかったし、ベルソムラも飲むことはありませんでした。
現在の家に引っ越してくるタイミングで、年数も経ってるしもう飲むこともないだろうと、余っていたベルソムラをすべて処分しました。&lt;/p&gt;
&lt;p&gt;年始、実家に帰省をしようと荷物を整理していた際、スーツケースの中から捨てたはずのベルソムラが1シートだけ出てきました。
偶然紛れ込んでいたみたいで、それを見たら不眠だった頃を少しだけ思い出しました。
このベルソムラのシートは、お守りとして取っておくことにしました。&lt;/p&gt;
&lt;p&gt;その後実家に数日間帰省し、一回だけ中途覚醒しました。
そのときの夢も、父親と喧嘩をする夢でした。&lt;/p&gt;
&lt;!-- raw HTML omitted --&gt;
&lt;section class=&#34;footnotes&#34; role=&#34;doc-endnotes&#34;&gt;
&lt;hr&gt;
&lt;ol&gt;
&lt;li id=&#34;fn:1&#34; role=&#34;doc-endnote&#34;&gt;
&lt;p&gt;2ch発のAAキャラクターやる夫を用いたショートストーリー、当時はGANTZのやる夫SSに張り付いていた覚えがある&amp;#160;&lt;a href=&#34;#fnref:1&#34; class=&#34;footnote-backref&#34; role=&#34;doc-backlink&#34;&gt;&amp;#x21a9;&amp;#xfe0e;&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li id=&#34;fn:2&#34; role=&#34;doc-endnote&#34;&gt;
&lt;p&gt;オレキシン受容体拮抗作用をもつ割と新しめの睡眠薬&amp;#160;&lt;a href=&#34;#fnref:2&#34; class=&#34;footnote-backref&#34; role=&#34;doc-backlink&#34;&gt;&amp;#x21a9;&amp;#xfe0e;&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li id=&#34;fn:3&#34; role=&#34;doc-endnote&#34;&gt;
&lt;p&gt;痛かったです&amp;#160;&lt;a href=&#34;#fnref:3&#34; class=&#34;footnote-backref&#34; role=&#34;doc-backlink&#34;&gt;&amp;#x21a9;&amp;#xfe0e;&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;/section&gt;
</description>
    </item>
    
    
    
    <item>
      <title>20220115</title>
      <link>https://hanazonochateau.net/posts/2022/01/15/20220115/</link>
      <pubDate>Sat, 15 Jan 2022 17:21:27 +0900</pubDate>
      
      <guid>https://hanazonochateau.net/posts/2022/01/15/20220115/</guid>
      <description>&lt;p&gt;今日も寝たり寝なかったりの生活を送っていました。
どうしても中途覚醒してしまうので、午前中は諦めてこのサイトのレイアウトを弄ったりしていました。
午後は少し眠りました。\
食事ですが、祖母宅から届いたうどんを朝昼夜と連続で食べました。
レンジでチンするだけで食べられるようになる代物で、温めていると部屋の中に出汁のいい香りが広まって食欲を刺激されました。
食事は料理の香りを嗅ぐ時が一番幸せかもしれません。
三食分それぞれ具材が違ったので、飽きずに食べることができました。
うどん本体の出来も冷凍にしてはかなり良く、コシが感じられておいしかったです。
ごちそうさまでした。&lt;/p&gt;
&lt;h3 id=&#34;サイトのタイトル&#34;&gt;サイトのタイトル&lt;/h3&gt;
&lt;p&gt;自分のハンドルネームがサイトのタイトルなのもなんだかなあと思ったので、ウンウン唸って考えた結果、好きな本から主人公が住むアパートの名前を取ってサイトのタイトルとしました。
それに伴ってドメインも変更しました。
いつか由来となった本のことについても書こうと思います。&lt;/p&gt;
&lt;h3 id=&#34;角煮&#34;&gt;角煮&lt;/h3&gt;
&lt;p&gt;今日は三食うどんを食べたわけですが、僕の通う大学の近くにカレーうどん専門店があります。
そこのカレーうどんがこれまた絶品なのですが、特徴として角煮チャーシューのスライスが乗っていることが挙げられます。
その角煮チャーシューのスライスは本当にトロトロで、箸でスッと切れるほどやわらかいのです。
この角煮を作りたくて、インターネットで角煮の作り方を調べたことがあります。
それによると、角煮を作る際は圧力鍋を使ってはいけないとのことでした。
圧力鍋を使うと豚肉の細胞壁が破壊され、パサパサの角煮が出来上がってしまうようです。\
参考にしたページにはこう書かれていました。
まず一時間水で煮て、水を換えてもう一時間水煮します。
煮る方法にも注意が必要で、沸騰したら極弱火で温度を保つ程度にします。
その後はしょうゆ、砂糖、みりん、酒などで味付けをして、常温で冷ましながら味をしみこませればOK、といった感じでした。\
以前この作り方で友人と一緒に角煮を作ったことがあります。
味のしみこませ方が少し足りませんでしたが、満足のいく角煮に仕上がりました。
最近自炊ができていないので、やる気を出してまた作りたいです。&lt;/p&gt;
</description>
    </item>
    
    
    
    <item>
      <title>20220114</title>
      <link>https://hanazonochateau.net/posts/2022/01/14/20220114/</link>
      <pubDate>Fri, 14 Jan 2022 12:34:59 +0900</pubDate>
      
      <guid>https://hanazonochateau.net/posts/2022/01/14/20220114/</guid>
      <description>&lt;p&gt;今日は1時に起きてしまったので、ボーっとしながら酒を飲んでいました。&lt;/p&gt;
&lt;p&gt;ジンを三ツ矢サイダーとレモン汁で割ったものを飲んだのですが、レモン濃いめで作ったらおいしかったです。
後からこれはレモンチューハイだということに気づきました。
薬を飲み忘れていたことに気づいたので飲んだのですが、何も考えず酒と一緒に飲んでしまいました。&lt;/p&gt;
&lt;p&gt;眠気が来たので5時くらいに寝て、8時くらいに起きました。
もしかしたら起きたのは11時くらいだったかもしれません。
寝たのが8時だったかも。
この辺はあまりよく覚えてません。&lt;/p&gt;
&lt;p&gt;午後は私用を済ませた後、友人の引っ越し手伝いをしました。
身体を動かしたら気分が少し晴れました。
ご飯を食べたりスーパー銭湯に寄ったりして、帰ってきたら23時を過ぎていました。&lt;/p&gt;
&lt;h3 id=&#34;眠いとき&#34;&gt;眠いとき&lt;/h3&gt;
&lt;p&gt;眠いけどやらなきゃいけないことがあるときってみんなどうしているんでしょうか。
眠くなったけどどうしても活動したいときは、自分はエナジードリンクをよく飲みます。
体に悪いのはわかるんですが、なんともやめることができません。
大学受験の時にエナジードリンクを飲みまくって勉強してからその癖が抜けないです。
集中したいときはエナジードリンクを飲む習慣がついてしまって、よくありません。\
エナジードリンクを飲み続けると、結石とかができやすくなったり、痛風になったりするらしいです。
結石とか痛風とか、痛いのは嫌なので早くやめなきゃと思っています。
エナジードリンクから、コーヒーとか緑茶とかに乗り換えたいです。&lt;/p&gt;
&lt;p&gt;今日は風が強く吹いていました。&lt;/p&gt;
</description>
    </item>
    
    
    
    <item>
      <title>20220113</title>
      <link>https://hanazonochateau.net/posts/2022/01/13/20220113/</link>
      <pubDate>Thu, 13 Jan 2022 18:37:01 +0900</pubDate>
      
      <guid>https://hanazonochateau.net/posts/2022/01/13/20220113/</guid>
      <description>&lt;p&gt;今日はよく寝た気がするし、寝てない気もします。&lt;/p&gt;
&lt;p&gt;確か2時くらいに寝て、5時くらいに起きて、そこからパソコンいじりをしました。
パソコンいじりはまあまあ集中できた気がします。\
9時くらいに眠くなったから横になったら、17時になっていました。&lt;/p&gt;
&lt;p&gt;昨日とはうって変わって空腹になりません。
さすがに何も食べないのはまずいだろうと、カロリーメイトを2本食べました。
カロリーメイトはそこそこビタミンとかミネラルとかも入っているので、何も考えずに口に入れるものとしてはかなり優秀だなあと思います。
きっとこういう生活を毎日続けたら痩せるんでしょうね。\
世の中の人々は食に興味が無いんでしょうか。
今日は例外ですが、自分はいつもお腹が空いている気がします。
おかげでいつも食事について考えています。&lt;/p&gt;
&lt;p&gt;最近眠ると大抵は嫌な夢を見ます。
嫌な夢は起きて30分も経ったら内容は忘れてしまうのですが、嫌な夢だったなあということはいつまでも覚えてしまっていて、寝るのが少し憂鬱になります。\
なんだか眠りも浅い気がします。
たびたび起きてしまうし、疲れも取れた気がしません。
起きていても眠い時が多いです。すぐ横になってしまいます。&lt;/p&gt;
&lt;p&gt;たぶん寝室にカーテンが無いのがいけないんだと思います。
自分の部屋は薄い白いカーテンはあるのですが、厚手の遮光してくれるカーテンはありません。
日中に寝ると、多分明るいからその分眠りが妨げられているのでしょう。\
早く遮光カーテンを買いたいです、とびきり遮光するやつを買おうかしら。&lt;/p&gt;
&lt;p&gt;頭はボーっとしてますが、眠るほどではない時って、難しいです。
今がそうです。&lt;/p&gt;
</description>
    </item>
    
    
    
    <item>
      <title>20220112</title>
      <link>https://hanazonochateau.net/posts/2022/01/12/20220112/</link>
      <pubDate>Wed, 12 Jan 2022 18:26:45 +0900</pubDate>
      
      <guid>https://hanazonochateau.net/posts/2022/01/12/20220112/</guid>
      <description>&lt;p&gt;今日は気分が悪いです。&lt;/p&gt;
&lt;p&gt;気分が悪い上に寝不足なので、友人と約束していた昼食では黙り込んでしまいました。
食欲だけはたくさんあったので、おかわりのキャベツをたくさん食べました。&lt;/p&gt;
&lt;p&gt;気分が悪いので抗鬱剤を飲んだら数時間後にマシになりました。
調子が上がってきたので昼間とは別の友人と夕飯を食べました。
食欲はまだたくさんあったので大盛を頼みました、友人含め3人の中で一番早く食べ終わりました。\
その後友人宅にお邪魔して、少し世間話をしました。
今度は普通に話すことができました。&lt;/p&gt;
&lt;p&gt;人は脳内物質でここまで左右されるものかと思うと少し悲しいです。&lt;/p&gt;
&lt;p&gt;帰り道自転車を漕いでいたら、腹の中に収まってた夕飯を戻しそうになりましたが、なんとか飲み込んで家まで帰りました。
家に戻った頃には吐き気はなくなっていました。&lt;/p&gt;
&lt;p&gt;今日は顔に吹きかかる風が強くて、冷たかったです。&lt;/p&gt;
</description>
    </item>
    
    
    
    
    
    
    
    
  </channel>
</rss>
